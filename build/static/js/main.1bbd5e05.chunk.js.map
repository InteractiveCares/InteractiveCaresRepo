{"version":3,"sources":["components/LoginPage/video-logo.png","components/VideoProvider/useSelectedParticipant/useSelectedParticipant.tsx","components/VideoProvider/useLocalTracks/useLocalTracks.ts","components/VideoProvider/index.tsx","components/VideoProvider/useRoom/useRoom.tsx","components/VideoProvider/useHandleRoomDisconnectionErrors/useHandleRoomDisconnectionErrors.ts","components/VideoProvider/useHandleTrackPublicationFailed/useHandleTrackPublicationFailed.ts","components/VideoProvider/useHandleOnDisconnect/useHandleOnDisconnect.ts","hooks/useVideoContext/useVideoContext.ts","components/Controls/EndCallButton/EndCallButton.tsx","hooks/useLocalAudioToggle/useLocalAudioToggle.tsx","hooks/useIsTrackEnabled/useIsTrackEnabled.tsx","components/Controls/ToggleAudioButton/ToggleAudioButton.tsx","components/Controls/ToggleVideoButton/ToggleVideoButton.tsx","hooks/useLocalVideoToggle/useLocalVideoToggle.tsx","hooks/useScreenShareParticipant/useScreenShareParticipant.tsx","components/Controls/ToogleScreenShareButton/ToggleScreenShareButton.tsx","hooks/useScreenShareToggle/useScreenShareToggle.tsx","hooks/useRoomState/useRoomState.tsx","components/Controls/Controls.tsx","components/Controls/useIsUserActive/useIsUserActive.ts","components/VideoTrack/VideoTrack.tsx","components/LocalVideoPreview/LocalVideoPreview.tsx","components/ToggleFullScreenButton/ToggleFullScreenButton.tsx","hooks/useFullScreenToggle/useFullScreenToggle.tsx","components/MenuBar/AboutDialog/AboutDialog.tsx","components/MenuBar/UserAvatar/UserAvatar.tsx","state/useFirebaseAuth/useFirebaseAuth.ts","state/usePasscodeAuth/usePasscodeAuth.ts","state/index.tsx","components/MenuBar/Menu/Menu.tsx","components/MenuBar/MenuBar.tsx","components/ReconnectingNotification/ReconnectingNotification.tsx","components/BandwidthWarning/BandwidthWarning.tsx","components/NewtorkQualityLevel/NetworkQualityLevel.tsx","components/ParticipantInfo/ParticipantConnectionIndicator/ParticipantConnectionIndicator.tsx","hooks/useParticipantIsReconnecting/useParticipantIsReconnecting.ts","components/ParticipantInfo/PinIcon/PinIcon.tsx","hooks/usePublications/usePublications.tsx","hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff.tsx","hooks/useTrack/useTrack.tsx","components/ParticipantInfo/ParticipantInfo.tsx","hooks/useParticipantNetworkQualityLevel/useParticipantNetworkQualityLevel.tsx","hooks/usePublicationIsTrackEnabled/usePublicationIsTrackEnabled.tsx","components/AudioTrack/AudioTrack.tsx","components/Publication/Publication.tsx","components/ParticipantTracks/ParticipantTracks.tsx","components/Participant/Participant.tsx","hooks/useDominantSpeaker/useDominantSpeaker.tsx","hooks/useParticipants/useParticipants.tsx","components/ParticipantStrip/ParticipantStrip.tsx","components/MainParticipantInfo/MainParticipantInfo.tsx","components/MainParticipant/MainParticipant.tsx","hooks/useMainSpeaker/useMainSpeaker.tsx","components/Room/Room.tsx","App.tsx","components/ErrorDialog/ErrorDialog.tsx","components/ErrorDialog/enhanceMessage.ts","components/LoginPage/google-logo.svg","components/LoginPage/twilio-logo.svg","components/LoginPage/LoginPage.tsx","components/PrivateRoute/PrivateRoute.tsx","theme.ts","index.tsx"],"names":["module","exports","selectedParticipantContext","createContext","useSelectedParticipant","useContext","SelectedParticipantProvider","room","children","useState","selectedParticipant","_setSelectedParticipant","useEffect","onDisconnect","on","off","Provider","value","participant","prevParticipant","useLocalTracks","audioTrack","track","setTrack","Video","createLocalAudioTrack","then","newTrack","handleStopped","undefined","useLocalAudioTrack","getLocalVideoTrack","useCallback","createLocalVideoTrack","frameRate","height","width","name","useLocalVideoTrack","videoTrack","localTracks","filter","VideoContext","VideoProvider","options","onError","onErrorCallback","error","console","log","message","EventEmitter","setRoom","isConnecting","setIsConnecting","disconnectHandlerRef","useRef","localTracksRef","current","connect","token","tracks","newRoom","once","setTimeout","window","removeEventListener","twilioRoom","forEach","localParticipant","publishTrack","priority","kind","disconnect","addEventListener","useRoom","onDisconnected","useHandleRoomDisconnectionErrors","useHandleTrackPublicationFailed","useHandleOnDisconnect","useVideoContext","context","Error","useStyles","makeStyles","theme","createStyles","fab","margin","spacing","EndCallButton","classes","Tooltip","title","onClick","placement","PopperProps","disablePortal","Fab","className","color","useLocalAudioToggle","find","isEnabled","setIsEnabled","setEnabled","setDisabled","useIsTrackEnabled","disable","enable","ToggleAudioButton","props","isAudioEnabled","toggleAudioEnabled","disabled","data-cy-audio-toggle","ToggleVideoButton","toggleVideoEnabled","localTrackPublication","unpublishTrack","emit","stop","useLocalVideoToggle","isVideoEnabled","useScreenShareParticipant","screenShareParticipant","setScreenShareParticipant","state","updateScreenShareParticipant","Array","from","participants","values","concat","trackName","backgroundColor","ToggleScreenShareButton","isSharing","setIsSharing","stopScreenShareRef","shareScreen","navigator","mediaDevices","getDisplayMedia","audio","video","stream","getTracks","trackPublication","onended","catch","toggleScreenShare","useScreenShareToggle","isScreenShared","disableScreenShareButton","isScreenShareSupported","isDisabled","tooltipMessage","style","cursor","useRoomState","setState","setRoomState","container","display","position","right","transform","bottom","zIndex","transition","opacity","visibility","Controls","roomState","isReconnecting","showControls","isUserActive","setIsUserActive","timeoutIDRef","handleUserActivity","throttle","clearTimeout","timeoutID","useIsUserActive","clsx","styled","maxHeight","objectFit","VideoTrack","isLocal","ref","el","muted","setPriority","attach","detach","LocalVideoPreview","FullscreenButton","IconButton","marginLeft","ToggleFullscreenButton","fscreen","fullscreenElement","isFullScreen","setIsFullScreen","onFullScreenChange","toggleFullScreen","exitFullscreen","requestFullscreen","document","documentElement","useFullScreenToggle","aria-label","AboutDialog","open","onClose","Dialog","fullWidth","maxWidth","DialogTitle","DialogContent","DialogContentText","String","isSupported","version","appVersion","process","REACT_APP_GIT_TAG","REACT_APP_GIT_COMMIT","DialogActions","Button","autoFocus","red","UserAvatar","user","displayName","photoURL","Avatar","src","split","map","text","join","toUpperCase","firebaseConfig","apiKey","REACT_APP_FIREBASE_API_KEY","authDomain","REACT_APP_FIREBASE_AUTH_DOMAIN","databaseURL","REACT_APP_FIREBASE_DATABASE_URL","storageBucket","REACT_APP_FIREBASE_STORAGE_BUCKET","messagingSenderId","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","fetchToken","passcode","fetch","method","headers","body","JSON","stringify","user_identity","room_name","verifyPasscode","res","a","json","jsonResponse","status","isValid","ok","usePasscodeAuth","history","useHistory","setUser","isAuthReady","setIsAuthReady","getToken","match","location","search","sessionStorage","getItem","getPasscode","verification","setItem","replace","pathname","signIn","getErrorMessage","signOut","removeItem","Promise","resolve","StateContext","useAppState","Menu","aboutOpen","setAboutOpen","menuOpen","setMenuOpen","anchorRef","handleSignOut","anchorEl","MenuItem","palette","background","default","form","alignItems","textField","marginRight","loadingSpinner","minWidth","fontWeight","MenuBar","URLRoomName","useParams","setName","roomName","setRoomName","AppBar","Toolbar","onSubmit","event","preventDefault","origin","includes","replaceState","encodeURI","Typography","variant","TextField","id","label","onChange","target","type","CircularProgress","snackbar","icon","ReconnectingNotification","Snackbar","anchorOrigin","vertical","horizontal","SnackbarContent","BandwidthWarningContainer","flexDirection","justifyContent","Warning","textAlign","BandwidthWarning","fontSize","Container","border","boxSizing","borderRight","NetworkQualityLevel","qualityLevel","level","key","indicator","borderRadius","ParticipantConnectionIndicator","setIsReconnecting","handleReconnecting","handleReconnected","useParticipantIsReconnecting","PinIcon","SvgIcon","float","usePublications","publications","setPublications","publicationAdded","publication","prevPublications","publicationRemoved","p","useIsTrackSwitchedOff","isSwitchedOff","setIsSwitchedOff","handleSwitchedOff","handleSwitchedOn","useTrack","removeTrack","sidebarWidth","overflow","stroke","strokeWidth","isVideoSwitchedOff","infoContainer","padding","hideVideo","identity","infoRow","ParticipantInfo","isSelected","audioPublication","videoPublication","networkQualityLevel","setNetworkQualityLevel","handleNewtorkQualityLevelChange","newNetworkQualityLevel","useParticipantNetworkQualityLevel","isTrackEnabled","usePublicationIsTrackEnabled","Boolean","isScreenShareEnabled","data-cy-participant","data-cy-audio-mute-icon","AudioTrack","Publication","disableAudio","videoPriority","ParticipantTracks","filteredPublications","enableScreenShare","some","Participant","useDominantSpeaker","dominantSpeaker","setDominantSpeaker","handleDominantSpeakerChanged","newDominantSpeaker","handleParticipantDisconnected","prevDominantSpeaker","useParticipants","setParticipants","prevParticipants","participantConnected","participantDisconnected","top","left","overflowY","ParticipantStrip","setSelectedParticipant","sid","MainParticipantInfo","screenSharePublication","data-cy-main-participant","MainParticipant","mainParticipant","useMainSpeaker","MainParticipantContainer","Room","Main","App","ErrorDialog","dismissError","code","enhancedMessage","enhanceMessage","_extends","Object","assign","i","arguments","length","source","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","createElement","_ref3","_ref4","x","y","filterUnits","dx","dy","in","result","stdDeviation","rx","_ref5","fill","fillRule","d","_ref","svgRef","viewBox","ForwardRef","forwardRef","twilioLogo","videoLogo","paper","marginTop","button","textTransform","errorMessage","createMuiTheme","PrivateRoute","rest","renderChildren","REACT_APP_SET_AUTH","render","to","primary","main","connectionOptions","bandwidthProfile","mode","renderDimensions","high","standard","low","maxAudioBitrate","networkQuality","local","remote","preferredVideoCodecs","codec","simulcast","VideoApp","setError","ReactDOM","CssBaseline","contextValue","Headers","getIdToken","idToken","set","endpoint","REACT_APP_TOKEN_ENDPOINT","params","URLSearchParams","firebase","onAuthStateChanged","provider","GoogleAuthProvider","addScope","signInWithPopup","useFirebaseAuth","err","reject","exact","path","useLocation","setPasscode","authError","setAuthError","isAuthEnabled","login","ThemeProvider","Grid","justify","Paper","elevation","alt","startIcon","e","direction","getElementById"],"mappings":"gLAAAA,EAAOC,QAAU,k+D,kNCKJC,EAA6BC,wBAA8C,MAEzE,SAASC,IAA0B,IAAD,EACOC,qBAAWH,GADlB,mBAE/C,MAAO,CAFwC,WAU1C,SAASI,EAAT,GAA4F,IAArDC,EAAoD,EAApDA,KAAMC,EAA8C,EAA9CA,SAA8C,EACzCC,mBAA6B,MADY,mBACzFC,EADyF,KACpEC,EADoE,KAahG,OARAC,qBAAU,WACR,IAAMC,EAAe,kBAAMF,EAAwB,OAEnD,OADAJ,EAAKO,GAAG,eAAgBD,GACjB,WACLN,EAAKQ,IAAI,eAAgBF,MAE1B,CAACN,IAGF,kBAACL,EAA2Bc,SAA5B,CAAqCC,MAAO,CAACP,EAZhB,SAACQ,GAAD,OAC7BP,GAAwB,SAAAQ,GAAe,OAAKA,IAAoBD,EAAc,KAAOA,QAYlFV,G,qBC4BQ,SAASY,IACtB,IAAMC,EA1DD,WAA+B,IAAD,EACTZ,qBADS,mBAC5Ba,EAD4B,KACrBC,EADqB,KAmBnC,OAhBAX,qBAAU,WACRY,IAAMC,wBAAwBC,MAAK,SAAAC,GACjCJ,EAASI,QAEV,IAEHf,qBAAU,WACR,IAAMgB,EAAgB,kBAAML,OAASM,IACrC,GAAIP,EAEF,OADAA,EAAMR,GAAG,UAAWc,GACb,WACLN,EAAMP,IAAI,UAAWa,MAGxB,CAACN,IAEGA,EAuCYQ,GADoB,EAnClC,WAA+B,IAAD,EACTrB,qBADS,mBAC5Ba,EAD4B,KACrBC,EADqB,KAG7BQ,EAAqBC,uBACzB,kBACER,IAAMS,sBAAsB,CAC1BC,UAAW,GACXC,OAAQ,IACRC,MAAO,KACPC,KAAM,WACLX,MAAK,SAAAC,GAEN,OADAJ,EAASI,GACFA,OAEX,IAkBF,OAfAf,qBAAU,WAERmB,MACC,CAACA,IAEJnB,qBAAU,WACR,IAAMgB,EAAgB,kBAAML,OAASM,IACrC,GAAIP,EAEF,OADAA,EAAMR,GAAG,UAAWc,GACb,WACLN,EAAMP,IAAI,UAAWa,MAGxB,CAACN,IAEG,CAACA,EAAOS,GAK0BO,GAFF,mBAEhCC,EAFgC,KAEpBR,EAFoB,KASvC,MAAO,CAAES,YALW,CAACnB,EAAYkB,GAAYE,QAAO,SAAAnB,GAAK,YAAcO,IAAVP,KAKvCS,sB,6BCzCjB,IAAMW,EAAevC,wBAA6B,MASlD,SAASwC,EAAT,GAAgH,IAAvFC,EAAsF,EAAtFA,QAASpC,EAA6E,EAA7EA,SAA6E,IAAnEqC,eAAmE,MAAzD,aAAyD,MAA/ChC,oBAA+C,MAAhC,aAAgC,EAC9GiC,EAAkB,SAACC,GACvBC,QAAQC,IAAR,iBAAsBF,EAAMG,SAAWH,GACvCF,EAAQE,IAH0G,EAMxE3B,IAApCoB,EAN4G,EAM5GA,YAAaT,EAN+F,EAM/FA,mBAN+F,EChCvG,SAAiBS,EAA2BK,EAAmBD,GAA2B,IAAD,EAC9EnC,mBAAe,IAAI0C,KAD2D,mBAC/F5C,EAD+F,KACzF6C,EADyF,OAE9D3C,oBAAS,GAFqD,mBAE/F4C,EAF+F,KAEjFC,EAFiF,KAGhGC,EAAuBC,kBAAmB,eAC1CC,EAAiBD,iBAAqB,IAiD5C,OA/CA5C,qBAAU,WAIR6C,EAAeC,QAAUlB,IACxB,CAACA,IA0CG,CAAEjC,OAAM8C,eAAcM,QAxCb3B,uBACd,SAAA4B,GAEE,OADAN,GAAgB,GACT9B,IAAMmC,QAAQC,EAAd,eAA0BhB,EAA1B,CAAmCiB,OAAQ,MAAMnC,MACtD,SAAAoC,GACEV,EAAQU,GAERA,EAAQC,KAAK,gBAAgB,WAE3BC,YAAW,kBAAMZ,EAAQ,IAAID,QAC7Bc,OAAOC,oBAAoB,eAAgBX,EAAqBG,YAIlEO,OAAOE,WAAaL,EAEpBL,EAAeC,QAAQU,SAAQ,SAAA9C,GAAK,OAMlCwC,EAAQO,iBAAiBC,aAAahD,EAAO,CAAEiD,SAAyB,UAAfjD,EAAMkD,KAAmB,MAAQ,gBAG5FjB,EAAqBG,QAAU,kBAAMI,EAAQW,cAC7CnB,GAAgB,GAGhBW,OAAOS,iBAAiB,eAAgBnB,EAAqBG,YAE/D,SAAAX,GACEF,EAAQE,GACRO,GAAgB,QAItB,CAACV,EAASC,KDX4B8B,CAAQnC,EAAaM,EAAiBF,GAAtErC,EAP4G,EAO5GA,KAAM8C,EAPsG,EAOtGA,aAAcM,EAPwF,EAOxFA,QAO5B,OE9Ca,SAA0CpD,EAAYsC,GACnEjC,qBAAU,WACR,IAAMgE,EAAiB,SAACrE,EAAYwC,GAC9BA,GACFF,EAAQE,IAKZ,OADAxC,EAAKO,GAAG,eAAgB8D,GACjB,WACLrE,EAAKQ,IAAI,eAAgB6D,MAE1B,CAACrE,EAAMsC,IF8BVgC,CAAiCtE,EAAMsC,GG1C1B,SAAyCtC,EAAYsC,GAAoB,IAC9EwB,EAAqB9D,EAArB8D,iBACRzD,qBAAU,WACR,GAAIyD,EAEF,OADAA,EAAiBvD,GAAG,yBAA0B+B,GACvC,WACLwB,EAAiBtD,IAAI,yBAA0B8B,MAGlD,CAACwB,EAAkBxB,IHkCtBiC,CAAgCvE,EAAMsC,GI5CzB,SAA+BtC,EAAYM,GACxDD,qBAAU,WAER,OADAL,EAAKO,GAAG,eAAgBD,GACjB,WACLN,EAAKQ,IAAI,eAAgBF,MAE1B,CAACN,EAAMM,IJuCVkE,CAAsBxE,EAAMM,GAG1B,kBAAC6B,EAAa1B,SAAd,CACEC,MAAO,CACLV,OACAiC,cACAa,eACAR,QAASC,EACTjC,eACAkB,qBACA4B,YAGF,kBAACrD,EAAD,CAA6BC,KAAMA,GAAOC,IK5DjC,SAASwE,IACtB,IAAMC,EAAU5E,qBAAWqC,GAC3B,IAAKuC,EACH,MAAM,IAAIC,MAAM,uDAElB,OAAOD,ECCT,IAAME,EAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACXC,IAAK,CACHC,OAAQH,EAAMI,QAAQ,SAKb,SAASC,IACtB,IAAMC,EAAUR,IACR5E,EAASyE,IAATzE,KAER,OACE,kBAACqF,EAAA,EAAD,CAASC,MAAO,WAAYC,QAAS,kBAAMvF,EAAKkE,cAAcsB,UAAU,MAAMC,YAAa,CAAEC,eAAe,IAC1G,kBAACC,EAAA,EAAD,CAAKC,UAAWR,EAAQJ,IAAKa,MAAM,WACjC,kBAAC,IAAD,Q,uCCnBO,SAASC,IAAuB,IAEvChF,EADkB2D,IAAhBxC,YACuB8D,MAAK,SAAAhF,GAAK,MAAmB,UAAfA,EAAMkD,QASnD,MAAO,CCXM,SAA2BlD,GAAmB,IAAD,EACxBb,oBAASa,GAAQA,EAAMiF,WADC,mBACnDA,EADmD,KACxCC,EADwC,KAkB1D,OAfA5F,qBAAU,WAGR,GAFA4F,GAAalF,GAAQA,EAAMiF,WAEvBjF,EAAO,CACT,IAAMmF,EAAa,kBAAMD,GAAa,IAChCE,EAAc,kBAAMF,GAAa,IAGvC,OAFAlF,EAAMR,GAAG,UAAW2F,GACpBnF,EAAMR,GAAG,WAAY4F,GACd,WACLpF,EAAMP,IAAI,UAAW0F,GACrBnF,EAAMP,IAAI,WAAY2F,OAGzB,CAACpF,IAEGiF,EDfWI,CAAkBtF,GAETW,uBAAY,WACjCX,IACFA,EAAWkF,UAAYlF,EAAWuF,UAAYvF,EAAWwF,YAE1D,CAACxF,KEJN,IAAM8D,EAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACXC,IAAK,CACHC,OAAQH,EAAMI,QAAQ,SAKb,SAASqB,EAAkBC,GACxC,IAAMpB,EAAUR,IADuD,EAE1BkB,IAF0B,mBAEhEW,EAFgE,KAEhDC,EAFgD,KAIvE,OACE,kBAACrB,EAAA,EAAD,CACEC,MAAOmB,EAAiB,aAAe,eACvCjB,UAAU,MACVC,YAAa,CAAEC,eAAe,IAE9B,kBAACC,EAAA,EAAD,CAAKC,UAAWR,EAAQJ,IAAKO,QAASmB,EAAoBC,SAAUH,EAAMG,SAAUC,wBAAA,GACjFH,EAAiB,kBAAC,IAAD,MAAU,kBAAC,IAAD,Q,uCCnBpC,IAAM7B,EAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACXC,IAAK,CACHC,OAAQH,EAAMI,QAAQ,SAKb,SAAS2B,EAAkBL,GACxC,IAAMpB,EAAUR,IADuD,ECd1D,WAAgC,IAAD,EAKxCH,IAHMX,EAFkC,EAE1C9D,KAAQ8D,iBACR7B,EAH0C,EAG1CA,YACAT,EAJ0C,EAI1CA,mBAEIQ,EAAaC,EAAY8D,MAAK,SAAAhF,GAAK,MAAmB,WAAfA,EAAMe,QAE7CgF,EAAqBrF,uBAAY,WACrC,GAAIO,EAAY,CACd,GAAI8B,EAAkB,CACpB,IAAMiD,EAAwBjD,EAAiBkD,eAAehF,GAE9D8B,EAAiBmD,KAAK,mBAAoBF,GAE5C/E,EAAWkF,YAEX1F,IAAqBL,MAAK,SAACJ,GACrB+C,GACFA,EAAiBC,aAAahD,QAInC,CAACiB,EAAY8B,EAAkBtC,IAElC,MAAO,GAAGQ,EAAY8E,GDTuBK,GAF0B,mBAEhEC,EAFgE,KAEhDN,EAFgD,KAIvE,OACE,kBAACzB,EAAA,EAAD,CACEC,MAAO8B,EAAiB,aAAe,eACvC5B,UAAU,MACVC,YAAa,CAAEC,eAAe,IAE9B,kBAACC,EAAA,EAAD,CAAKC,UAAWR,EAAQJ,IAAKO,QAASuB,EAAoBH,SAAUH,EAAMG,UACvES,EAAiB,kBAAC,IAAD,MAAe,kBAAC,IAAD,Q,uCEpB1B,SAASC,IAA6B,IAC3CrH,EAASyE,IAATzE,KAD0C,EAEUE,qBAFV,mBAE3CoH,EAF2C,KAEnBC,EAFmB,KAqClD,OAjCAlH,qBAAU,WACR,GAAmB,cAAfL,EAAKwH,MAAuB,CAC9B,IAAMC,EAA+B,WACnCF,EACEG,MAAMC,KAAkB3H,EAAK4H,aAAaC,UAEvCC,OAAO9H,EAAK8D,kBACZiC,MAAK,SAACpF,GAAD,OACJ+G,MAAMC,KAAuBhH,EAAY2C,OAAOuE,UAAU9B,MAAK,SAAAhF,GAAK,MAAwB,WAApBA,EAAMgH,kBActF,OAVAN,IAEAzH,EAAKO,GAAG,iBAAkBkH,GAC1BzH,EAAKO,GAAG,mBAAoBkH,GAC5BzH,EAAKO,GAAG,0BAA2BkH,GAInCzH,EAAK8D,iBAAiBvD,GAAG,iBAAkBkH,GAC3CzH,EAAK8D,iBAAiBvD,GAAG,mBAAoBkH,GACtC,WACLzH,EAAKQ,IAAI,iBAAkBiH,GAC3BzH,EAAKQ,IAAI,mBAAoBiH,GAC7BzH,EAAKQ,IAAI,0BAA2BiH,GAEpCzH,EAAK8D,iBAAiBtD,IAAI,iBAAkBiH,GAC5CzH,EAAK8D,iBAAiBtD,IAAI,mBAAoBiH,OAGjD,CAACzH,IAEGsH,EClCF,IAKD1C,EAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACXC,IAAK,CACHC,OAAQH,EAAMI,QAAQ,GACtB,cAAe,CACbW,MAAO,2BACPmC,gBAAiB,mCAMV,SAASC,EAAwBzB,GAC9C,IAAMpB,EAAUR,IAD6D,ECnBhE,WAAiC,IAAD,EACnBH,IAAlBzE,EADqC,EACrCA,KAAMsC,EAD+B,EAC/BA,QAD+B,EAEXpC,oBAAS,GAFE,mBAEtCgI,EAFsC,KAE3BC,EAF2B,KAGvCC,EAAqBnF,iBAAmB,MAExCoF,EAAc5G,uBAAY,WAC9B6G,UAAUC,aACPC,gBAAgB,CACfC,OAAO,EACPC,MAAO,CACL/G,UAAW,GACXC,OAAQ,KACRC,MAAO,QAGVV,MAAK,SAAAwH,GACJ,IAAM5H,EAAQ4H,EAAOC,YAAY,GAKjC5I,EAAK8D,iBACFC,aAAahD,EAAO,CACnBe,KAAM,SACNkC,SAAU,SAEX7C,MAAK,SAAA0H,GACJT,EAAmBjF,QAAU,WAC3BnD,EAAK8D,iBAAiBkD,eAAejG,GAErCf,EAAK8D,iBAAiBmD,KAAK,mBAAoB4B,GAC/C9H,EAAMmG,OACNiB,GAAa,IAGfpH,EAAM+H,QAAUV,EAAmBjF,QACnCgF,GAAa,MAEdY,MAAMzG,MAEVyG,OAAM,SAAAvG,GAEc,eAAfA,EAAMV,MAAwC,oBAAfU,EAAMV,MACvCQ,EAAQE,QAGb,CAACxC,EAAMsC,IAEJ0G,EAAoBvH,uBAAY,WACnCyG,EAA4BE,EAAmBjF,UAAnCkF,MACZ,CAACH,EAAWG,EAAaD,IAE5B,MAAO,CAACF,EAAWc,GD/ByBC,GAFiC,mBAEtEC,EAFsE,KAEtDF,EAFsD,KAGvE1B,EAAyBD,IACvBrH,EAASyE,IAATzE,KACFmJ,EAA2B7B,GAA0BA,IAA2BtH,EAAK8D,iBACrFsF,EAAyBd,UAAUC,cAAgBD,UAAUC,aAAaC,gBAC1Ea,EAAa7C,EAAMG,UAAYwC,IAA6BC,EAE9DE,EA1B2B,eAwC/B,OAZIJ,IACFI,EA5BkC,uBA+BhCH,IACFG,EA/BkC,oDAkC/BF,IACHE,EAlCoC,qDAsCpC,kBAACjE,EAAA,EAAD,CACEC,MAAOgE,EACP9D,UAAU,MACVC,YAAa,CAAEC,eAAe,GAC9B6D,MAAO,CAAEC,OAAQH,EAAa,cAAgB,YAE9C,6BAGE,kBAAC1D,EAAA,EAAD,CAAKC,UAAWR,EAAQJ,IAAKO,QAASyD,EAAmBrC,SAAU0C,GAChEH,EAAiB,kBAAC,IAAD,MAAsB,kBAAC,IAAD,S,sBE1DnC,SAASO,KAAgB,IAC9BzJ,EAASyE,IAATzE,KAD6B,EAEXE,mBAAwB,gBAFb,mBAE9BsH,EAF8B,KAEvBkC,EAFuB,KAmBrC,OAfArJ,qBAAU,WACR,IAAMsJ,EAAe,kBAAMD,EAAU1J,EAAKwH,OAAS,iBAMnD,OALAmC,IACA3J,EACGO,GAAG,eAAgBoJ,GACnBpJ,GAAG,cAAeoJ,GAClBpJ,GAAG,eAAgBoJ,GACf,WACL3J,EACGQ,IAAI,eAAgBmJ,GACpBnJ,IAAI,cAAemJ,GACnBnJ,IAAI,eAAgBmJ,MAExB,CAAC3J,IAEGwH,ECZT,IAAM5C,GAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACX6E,UAAW,CACTC,QAAS,OACTC,SAAU,WACVC,MAAO,MACPC,UAAW,uBACXC,OAAQ,OACRC,OAAQ,EACRC,WAAY,mDACZC,QAAS,EACTC,WAAY,SACZ,0BAA2B,CACzBF,WAAY,8CACZC,QAAS,EACTC,WAAY,UACZL,UAAW,6BAMJ,SAASM,KACtB,IAAMlF,EAAUR,KACV2F,EAAYd,KACZe,EAA+B,iBAAdD,EAEjBE,ECpCO,WAA4B,IAAD,EACAvK,oBAAS,GADT,mBACjCwK,EADiC,KACnBC,EADmB,KAElCC,EAAe3H,iBAAO,GAuB5B,OArBA5C,qBAAU,WACR,IAAMwK,EAAqBC,KAAS,WAClCH,GAAgB,GAChBI,aAAaH,EAAazH,SAC1B,IAAM6H,EAAYtH,OAAOD,YAAW,kBAAMkH,GAAgB,KAAQ,KAClEC,EAAazH,QAAU6H,IACtB,KAOH,OALAH,IAEAnH,OAAOS,iBAAiB,YAAa0G,GACrCnH,OAAOS,iBAAiB,QAAS0G,GACjCnH,OAAOS,iBAAiB,UAAW0G,GAC5B,WACLnH,OAAOC,oBAAoB,YAAakH,GACxCnH,OAAOC,oBAAoB,QAASkH,GACpCnH,OAAOC,oBAAoB,UAAWkH,GACtCE,aAAaH,EAAazH,YAE3B,IAEIuH,EDUcO,IAC8B,iBAAdV,EAErC,OACE,yBAAK3E,UAAWsF,YAAK9F,EAAQwE,UAAW,CAAEa,kBACxC,kBAAClE,EAAD,CAAmBI,SAAU6D,IAC7B,kBAAC3D,EAAD,CAAmBF,SAAU6D,IACd,iBAAdD,GACC,oCACE,kBAACtC,EAAD,CAAyBtB,SAAU6D,IACnC,kBAACrF,EAAD,QE3CV,IAAMlE,GAAQkK,YAAO,QAAPA,CAAgB,CAC5BtJ,MAAO,OACPuJ,UAAW,OACXC,UAAW,YASE,SAASC,GAAT,GAAoE,IAA9CvK,EAA6C,EAA7CA,MAAOwK,EAAsC,EAAtCA,QAASvH,EAA6B,EAA7BA,SAC7CwH,EAAMvI,iBAAyB,MAErC5C,qBAAU,WACR,IAAMoL,EAAKD,EAAIrI,QAMf,OALAsI,EAAGC,OAAQ,EACP3K,EAAM4K,aAAe3H,GACvBjD,EAAM4K,YAAY3H,GAEpBjD,EAAM6K,OAAOH,GACN,WACL1K,EAAM8K,OAAOJ,GACT1K,EAAM4K,aAAe3H,GAEvBjD,EAAM4K,YAAY,SAGrB,CAAC5K,EAAOiD,IAGX,IAAMuF,EAAQgC,EAAU,CAAEvB,UAAW,mBAAsB,GAE3D,OAAO,kBAAC/I,GAAD,CAAOuK,IAAKA,EAAKjC,MAAOA,IClClB,SAASuC,KAAqB,IAGrC9J,EAFkByC,IAAhBxC,YAEuB8D,MAAK,SAAAhF,GAAK,MAAmB,WAAfA,EAAMe,QAEnD,OAAOE,EAAa,kBAACsJ,GAAD,CAAYvK,MAAOiB,EAAYuJ,SAAO,IAAM,K,oHCDlE,IAAMQ,GAAmBZ,YAAOa,KAAPb,CAAmB,CAC1Cc,WAAY,SAGC,SAASC,KAA0B,IAAD,ECVlC,WAAgC,IAAD,EACJhM,qBAAoBiM,KAAQC,mBADxB,mBACrCC,EADqC,KACvBC,EADuB,KAG5CjM,qBAAU,WACR,IAAMkM,EAAqB,kBAAMD,IAAkBH,KAAQC,oBAE3D,OADAD,KAAQhI,iBAAiB,mBAAoBoI,GACtC,WACLJ,KAAQxI,oBAAoB,mBAAoB4I,MAEjD,IAEH,IAAMC,EAAmB/K,uBAAY,WACnC4K,EAAeF,KAAQM,iBAAmBN,KAAQO,kBAAkBC,SAASC,mBAC5E,CAACP,IAEJ,MAAO,CAACA,EAAcG,GDJmBK,GADM,mBACxCR,EADwC,KAC1BG,EAD0B,KAG/C,OACE,kBAACT,GAAD,CAAkBe,aAAA,cAA2BvH,QAASiH,GACnDH,EAAe,kBAAC,KAAD,MAAyB,kBAAC,KAAD,O,0EEkBhCU,OApBf,YAA8E,IAAvDC,EAAsD,EAAtDA,KAAMC,EAAgD,EAAhDA,QAC3B,OACE,kBAACC,GAAA,EAAD,CAAQF,KAAMA,EAAMC,QAASA,EAASE,WAAW,EAAMC,SAAS,MAC9D,kBAACC,GAAA,EAAD,eACA,kBAACC,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,2BAAuCC,OAAOvM,IAAMwM,cACpD,kBAACF,GAAA,EAAD,qBAAiCtM,IAAMyM,SACvC,kBAACH,GAAA,EAAD,qBAAiCI,MACjC,kBAACJ,GAAA,EAAD,sBAAkCK,8CAAYC,mBAAqB,OACnE,kBAACN,GAAA,EAAD,8BAA0CK,8CAAYE,sBAAwB,QAEhF,kBAACC,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CAAQzI,QAAS0H,EAASpH,MAAM,UAAUoI,WAAS,GAAnD,S,kFCtBFrJ,GAAYC,aAAW,CAC3BqJ,IAAK,CACHrI,MAAO,QACPmC,gBAAiB,aAYN,SAASmG,GAAT,GAAmE,IAA7CC,EAA4C,EAA5CA,KAC7BhJ,EAAUR,KAD+D,EAE7CwJ,EAA1BC,EAFuE,EAEvEA,YAAaC,EAF0D,EAE1DA,SAErB,OAAOA,EACL,kBAACC,GAAA,EAAD,CAAQC,IAAKF,IAEb,kBAACC,GAAA,EAAD,CAAQ3I,UAAWR,EAAQ8I,KAAMG,EAA0BA,EAb1DI,MAAM,KACNC,KAAI,SAAAC,GAAI,OAAIA,EAAK,MACjBC,KAAK,IACLC,cAUyE,kBAAC,KAAD,O,0CCxBxEC,I,OAAiB,CACrBC,OAAQnB,8CAAYoB,2BACpBC,WAAYrB,8CAAYsB,+BACxBC,YAAavB,8CAAYwB,gCACzBC,cAAezB,8CAAY0B,kCAC3BC,kBAAmB3B,8CAAY4B,yC,aCA1B,SAASC,GAAW3N,EAAc9B,EAAc0P,GACrD,OAAOC,MAAM,SAAU,CACrBC,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CAAEC,cAAenO,EAAMoO,UAAWlQ,EAAM0P,eAI1D,SAASS,GAAeT,GAC7B,OAAOD,GAAW,YAAa,YAAaC,GAAUvO,KAA/C,yCAAoD,WAAMiP,GAAN,kBAAAC,EAAA,sEAC9BD,EAAIE,OAD0B,UACnDC,EADmD,OAEtC,MAAfH,EAAII,OAFiD,yCAGhD,CAAEC,SAAS,EAAOjO,MAAK,UAAE+N,EAAa/N,aAAf,aAAE,EAAoBG,UAHG,WAMrDyN,EAAIM,KAAMH,EAAalN,MAN8B,yCAOhD,CAAEoN,SAAS,IAPqC,2CAApD,uDAuBM,SAASE,KACtB,IAAMC,EAAUC,eADwB,EAGhB3Q,mBAAmF,MAHnE,mBAGjCkO,EAHiC,KAG3B0C,EAH2B,OAIF5Q,oBAAS,GAJP,mBAIjC6Q,EAJiC,KAIpBC,EAJoB,KAMlCC,EAAWxP,uBACf,SAACK,EAAc9B,GACb,OAAOyP,GAAW3N,EAAM9B,EAAMoO,EAAMsB,UACjCvO,MAAK,SAAAiP,GAAG,OAAIA,EAAIE,UAChBnP,MAAK,SAAAiP,GAAG,OAAIA,EAAI/M,WAErB,CAAC+K,IAGH/N,qBAAU,WACR,IAAMqP,EAxDH,WACL,IAAMwB,EAAQxN,OAAOyN,SAASC,OAAOF,MAAM,mBAE3C,OADiBA,EAAQA,EAAM,GAAKxN,OAAO2N,eAAeC,QAAQ,YAsD/CC,GAEb7B,EACFS,GAAeT,GACZvO,MAAK,SAAAqQ,IACJ,OAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAcf,WAChBK,EAAQ,CAAEpB,aACVhM,OAAO2N,eAAeI,QAAQ,WAAY/B,GAC1CkB,EAAQc,QAAQhO,OAAOyN,SAASQ,cAGnCxQ,MAAK,kBAAM6P,GAAe,MAE7BA,GAAe,KAEhB,CAACJ,IAEJ,IAAMgB,EAASnQ,uBAAY,SAACiO,GAC1B,OAAOS,GAAeT,GAAUvO,MAAK,SAAAqQ,GACnC,UAAIA,QAAJ,IAAIA,MAAcf,QAIhB,MAAM,IAAI9L,MAlDX,SAAyBhC,GAC9B,OAAQA,GACN,IAAK,qBACH,MAAO,wBACT,IAAK,mBACH,MAAO,uBACT,QACE,OAAOA,GA2CWkP,CAAe,OAACL,QAAD,IAACA,OAAD,EAACA,EAAchP,QAH9CsO,EAAQ,CAAEpB,aACVhM,OAAO2N,eAAeI,QAAQ,WAAY/B,QAK7C,IAEGoC,EAAUrQ,uBAAY,WAG1B,OAFAqP,EAAQ,MACRpN,OAAO2N,eAAeU,WAAW,YAC1BC,QAAQC,YACd,IAEH,MAAO,CAAE7D,OAAM2C,cAAaE,WAAUW,SAAQE,WC7EzC,IAAMI,GAAetS,wBAAgC,MAkDrD,SAASuS,KACd,IAAMzN,EAAU5E,qBAAWoS,IAC3B,IAAKxN,EACH,MAAM,IAAIC,MAAM,wDAElB,OAAOD,EC5DM,SAAS0N,KAAQ,IAAD,EACHD,KAAlB/D,EADqB,EACrBA,KAAM0D,EADe,EACfA,QADe,EAECrN,IAAtBzE,EAFqB,EAErBA,KAAMiC,EAFe,EAEfA,YAFe,EAIK/B,oBAAS,GAJd,mBAItBmS,EAJsB,KAIXC,EAJW,OAKGpS,oBAAS,GALZ,mBAKtBqS,EALsB,KAKZC,EALY,KAOvBC,EAAYxP,iBAAuB,MAEnCyP,EAAgBjR,uBAAY,WAAO,IAAD,EACtC,UAAAzB,EAAKkE,kBAAL,cAAAlE,GACAiC,EAAY4B,SAAQ,SAAA9C,GAAK,OAAIA,EAAMmG,UAC5B,OAAP4K,QAAO,IAAPA,SACC,CAAC9R,EAAKkE,WAAYjC,EAAa6P,IAElC,OACE,yBAAKtG,IAAKiH,GACR,kBAACzG,GAAA,EAAD,CAAYnG,MAAM,UAAUN,QAAS,kBAAMiN,GAAY,SAAAhL,GAAK,OAAKA,OAC9D4G,EAAO,kBAACD,GAAD,CAAYC,KAAMA,IAAW,kBAAC,KAAD,OAEvC,kBAACgE,GAAA,EAAD,CAAepF,KAAMuF,EAAUtF,QAAS,kBAAMuF,GAAY,SAAAhL,GAAK,OAAKA,MAAQmL,SAAUF,EAAUtP,UACzF,OAAJiL,QAAI,IAAJA,OAAA,EAAAA,EAAMC,cAAe,kBAACuE,GAAA,EAAD,CAAUjM,UAAQ,GAAEyH,EAAKC,aAC/C,kBAACuE,GAAA,EAAD,CAAUrN,QAAS,kBAAM+M,GAAa,KAAtC,SACClE,GAAQ,kBAACwE,GAAA,EAAD,CAAUrN,QAASmN,GAAnB,WAEX,kBAAC,GAAD,CACE1F,KAAMqF,EACNpF,QAAS,WACPqF,GAAa,GACbE,GAAY,O,cCvBhB5N,GAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACX6E,UAAW,CACT5B,gBAAiBlD,EAAM+N,QAAQC,WAAWC,SAE5CC,KAAM,CACJnJ,QAAS,OACToJ,WAAY,UAEdC,UAAW,CACTjH,WAAYnH,EAAMI,QAAQ,GAC1BiO,YAAarO,EAAMI,QAAQ,GAC3BrD,MAAO,KAETuR,eAAgB,CACdnH,WAAY,OAEdoC,YAAa,CACXpC,WAAY,QACZoH,SAAU,QACVC,WAAY,UAKH,SAASC,KACtB,IAAMnO,EAAUR,KACR4O,EAAgBC,eAAhBD,YAFwB,EAGLrB,KAAnB/D,EAHwB,EAGxBA,KAAM6C,EAHkB,EAGlBA,SAHkB,EAIExM,IAA1B3B,EAJwB,EAIxBA,aAAcM,EAJU,EAIVA,QAChBmH,EAAYd,KALc,EAORvJ,oBAAqB,OAAJkO,QAAI,IAAJA,OAAA,EAAAA,EAAMC,cAAe,IAP9B,mBAOzBvM,EAPyB,KAOnB4R,EAPmB,OAQAxT,mBAAiB,IARjB,mBAQzByT,EARyB,KAQfC,EARe,KAUhCvT,qBAAU,WACJmT,GACFI,EAAYJ,KAEb,CAACA,IAmBJ,OACE,kBAACK,GAAA,EAAD,CAAQjO,UAAWR,EAAQwE,UAAWE,SAAS,UAC7C,kBAACgK,GAAA,EAAD,KACiB,iBAAdvJ,EACC,0BAAM3E,UAAWR,EAAQ4N,KAAMe,SAblB,SAACC,GACpBA,EAAMC,iBAEDvQ,OAAOyN,SAAS+C,OAAOC,SAAS,YACnCzQ,OAAOkN,QAAQwD,aAAa,KAAM,GAAI1Q,OAAO2Q,UAAP,gBAA0BV,KAElE1C,EAASnP,EAAM6R,GAAUxS,MAAK,SAAAkC,GAAK,OAAID,EAAQC,SAQtC,OAAC+K,QAAD,IAACA,OAAD,EAACA,EAAMC,aAUN,kBAACiG,GAAA,EAAD,CAAY1O,UAAWR,EAAQiJ,YAAakG,QAAQ,SACjDnG,EAAKC,aAVR,kBAACmG,GAAA,EAAD,CACEC,GAAG,YACHC,MAAM,OACN9O,UAAWR,EAAQ8N,UACnBxS,MAAOoB,EACP6S,SA5BW,SAACX,GACxBN,EAAQM,EAAMY,OAAOlU,QA4BTuE,OAAO,UAOX,kBAACuP,GAAA,EAAD,CACEC,GAAG,YACHC,MAAM,OACN9O,UAAWR,EAAQ8N,UACnBxS,MAAOiT,EACPgB,SArCiB,SAACX,GAC5BJ,EAAYI,EAAMY,OAAOlU,QAqCfuE,OAAO,UAET,kBAAC+I,GAAA,EAAD,CAAQ6G,KAAK,SAAShP,MAAM,UAAU0O,QAAQ,YAAY5N,SAAU7D,IAAiBhB,IAAS6R,GAA9F,aAGC7Q,GAAgB,kBAACgS,GAAA,EAAD,CAAkBlP,UAAWR,EAAQgO,kBAGxD,4BAAKO,GAEP,kBAACzH,GAAD,MACA,kBAAC,GAAD,Q,6CCtGFtH,GAAYC,YAAW,CAC3BkQ,SAAU,CACR/M,gBAAiB,WAEnBrF,QAAS,CACPkH,QAAS,OACToJ,WAAY,UAEd+B,KAAM,CACJ7B,YAAa,WAIF,SAAS8B,KACtB,IAAM7P,EAAUR,KACV2F,EAAYd,KAElB,OACE,kBAACyL,GAAA,EAAD,CAAUC,aAAc,CAAEC,SAAU,SAAUC,WAAY,SAAWrI,KAAoB,iBAAdzC,GACzE,kBAAC+K,GAAA,EAAD,CACE1P,UAAWR,EAAQ2P,SACnBpS,QACE,0BAAMiD,UAAWR,EAAQzC,SACvB,kBAAC,KAAD,CAAUiD,UAAWR,EAAQ4P,OAD/B,yB,iCC1BJO,GAA4BpK,YAAO,MAAPA,CAAc,CAC9CrB,SAAU,WACVI,OAAQ,EACRrI,MAAO,OACPgI,QAAS,OACT2L,cAAe,SACfC,eAAgB,SAChBxC,WAAY,WAGRyC,GAAUvK,YAAO,KAAPA,CAAa,CAC3BwK,UAAW,SACX1Q,OAAQ,YAGK,SAAS2Q,KACtB,OACE,kBAACL,GAAD,KACE,6BACE,kBAAC,KAAD,CAAkBM,SAAS,WAE7B,kBAACH,GAAD,gCCvBN,IAAMI,GAAY3K,YAAO,MAAPA,CAAc,CAC9BtB,QAAS,OACToJ,WAAY,WACZ,QAAS,CACPpR,MAAO,MACPkU,OAAQ,kBACRC,UAAW,cACX,qBAAsB,CACpBC,YAAa,WAOJ,SAASC,GAAT,GAAiF,IAAlDC,EAAiD,EAAjDA,aAC5C,OAAqB,OAAjBA,EAA8B,KAEhC,kBAACL,GAAD,KACG,CAAC,EAAG,EAAG,EAAG,EAAG,GAAGpH,KAAI,SAAA0H,GAAK,OACxB,yBACEC,IAAKD,EACL7M,MAAO,CACL3H,OAAO,GAAD,OAVL,GAUkBwU,EAAQ,GAArB,MACNtD,WAAYqD,EAAeC,EAAQ,OAAS,cCpBxD,IAAMxR,GAAYC,YAAW,CAC3ByR,UAAW,CACTzU,MAAO,OACPD,OAAQ,OACR2U,aAAc,OACdzD,WAAY,OACZjJ,QAAS,eACTsJ,YAAa,OAEf3I,eAAgB,CACdsI,WAAY,aAID,SAAS0D,GAAT,GAIX,IACIhM,ECvBO,SAAsC7J,GAAoD,IAAD,EAC1DT,oBAAS,GADiD,mBAC/FsK,EAD+F,KAC/EiM,EAD+E,KAetG,OAZApW,qBAAU,WACR,IAAMqW,EAAqB,kBAAMD,GAAkB,IAC7CE,EAAoB,kBAAMF,GAAkB,IAIlD,OAFA9V,EAAYJ,GAAG,eAAgBmW,GAC/B/V,EAAYJ,GAAG,cAAeoW,GACvB,WACLhW,EAAYH,IAAI,eAAgBkW,GAChC/V,EAAYH,IAAI,cAAemW,MAEhC,CAAChW,IAEG6J,EDQgBoM,CADtB,EAHDjW,aAKMyE,EAAUR,KAChB,OACE,kBAACS,EAAA,EAAD,CAASC,MAAOkF,EAAiB,8BAAgC,4BAC/D,0BAAM5E,UAAWsF,YAAK9F,EAAQkR,UAAT,gBAAuBlR,EAAQoF,eAAiBA,O,uBEzB5D,SAASqM,KACtB,OACE,kBAACxR,EAAA,EAAD,CAASC,MAAM,0CAA0CE,UAAU,OACjE,kBAACsR,GAAA,EAAD,CAASvN,MAAO,CAAEwN,MAAO,QAASlB,SAAU,SAC1C,kBAAC,KAAD,Q,aCJO,SAASmB,GAAgBrW,GAA2B,IAAD,EACxBT,mBAA6B,IADL,mBACzD+W,EADyD,KAC3CC,EAD2C,KAoBhE,OAjBA7W,qBAAU,WAER6W,EAAgBxP,MAAMC,KAAKhH,EAAY2C,OAAOuE,WAE9C,IAAMsP,EAAmB,SAACC,GAAD,OACvBF,GAAgB,SAAAG,GAAgB,6BAAQA,GAAR,CAA0BD,QACtDE,EAAqB,SAACF,GAAD,OACzBF,GAAgB,SAAAG,GAAgB,OAAIA,EAAiBnV,QAAO,SAAAqV,GAAC,OAAIA,IAAMH,SAIzE,OAFAzW,EAAYJ,GAAG,iBAAkB4W,GACjCxW,EAAYJ,GAAG,mBAAoB+W,GAC5B,WACL3W,EAAYH,IAAI,iBAAkB2W,GAClCxW,EAAYH,IAAI,mBAAoB8W,MAErC,CAAC3W,IAEGsW,ECjBM,SAASO,GAAsBzW,GAAmB,IAAD,EACpBb,mBAASa,GAASA,EAAM0W,eADJ,mBACvDA,EADuD,KACxCC,EADwC,KAmB9D,OAhBArX,qBAAU,WAIR,GAFAqX,EAAiB3W,GAASA,EAAM0W,eAE5B1W,EAAO,CACT,IAAM4W,EAAoB,kBAAMD,GAAiB,IAC3CE,EAAmB,kBAAMF,GAAiB,IAGhD,OAFA3W,EAAMR,GAAG,cAAeoX,GACxB5W,EAAMR,GAAG,aAAcqX,GAChB,WACL7W,EAAMP,IAAI,cAAemX,GACzB5W,EAAMP,IAAI,aAAcoX,OAG3B,CAAC7W,MAEK0W,ECxBI,SAASI,GAAST,GAA0E,IAAD,EAC9ElX,mBAASkX,GAAeA,EAAYrW,OAD0C,mBACjGA,EADiG,KAC1FC,EAD0F,KAmBxG,OAhBAX,qBAAU,WAIR,GAFAW,EAASoW,GAAeA,EAAYrW,OAEhCqW,EAAa,CACf,IAAMU,EAAc,kBAAM9W,EAAS,OAInC,OAFAoW,EAAY7W,GAAG,aAAcS,GAC7BoW,EAAY7W,GAAG,eAAgBuX,GACxB,WACLV,EAAY5W,IAAI,aAAcQ,GAC9BoW,EAAY5W,IAAI,eAAgBsX,OAGnC,CAACV,IAEGrW,ECHT,IAAM6D,GAAYC,aAAW,SAACC,GAAD,OAC3BC,YAAa,CACX6E,UAAW,CACTE,SAAU,WACVD,QAAS,OACToJ,WAAY,SACZrR,OAAO,GAAD,OAA2B,EAArBkD,EAAMiT,aAAoB,GAAhC,MACNC,SAAU,SACVxO,OAAQ,UACR,UAAW,CACTtH,OAAQ,QAEV,QAAS,CACP+V,OAAQ,QACRC,YAAa,UAGjBC,mBAAoB,CAClB,UAAW,CACTjW,OAAQ,2CAGZkW,cAAe,CACbtO,SAAU,WACVI,OAAQ,EACRL,QAAS,OACT2L,cAAe,SACfC,eAAgB,gBAChB7T,OAAQ,OACRyW,QAAS,QACTxW,MAAO,OACPiR,WAAY,eAEdwF,UAAW,CACTxF,WAAY,SAEdyF,SAAU,CACRzF,WAAY,qBACZuF,QAAS,cACTpT,OAAQ,EACR4E,QAAS,OACToJ,WAAY,UAEduF,QAAS,CACP3O,QAAS,OACT4L,eAAgB,sBAYP,SAASgD,GAAT,GAAgG,IAArE9X,EAAoE,EAApEA,YAAa4E,EAAuD,EAAvDA,QAASmT,EAA8C,EAA9CA,WAAYzY,EAAkC,EAAlCA,SACpEgX,EAAeD,GAAgBrW,GAE/BgY,EAAmB1B,EAAalR,MAAK,SAAAwR,GAAC,MAAe,UAAXA,EAAEtT,QAC5C2U,EAAmB3B,EAAalR,MAAK,SAAAwR,GAAC,MAAoB,WAAhBA,EAAExP,aAE5C8Q,EC/EO,SAA2ClY,GAAoD,IAAD,EACrDT,mBAASS,EAAYkY,qBADgC,mBACpGA,EADoG,KAC/EC,EAD+E,KAc3G,OAXAzY,qBAAU,WACR,IAAM0Y,EAAkC,SAACC,GAAD,OACtCF,EAAuBE,IAIzB,OAFAF,EAAuBnY,EAAYkY,qBACnClY,EAAYJ,GAAG,6BAA8BwY,GACtC,WACLpY,EAAYH,IAAI,6BAA8BuY,MAE/C,CAACpY,IAEGkY,EDiEqBI,CAAkCtY,GACxD8F,EE9EO,SAAsC2Q,GAAgC,IAAD,EAChDlX,qBAASkX,GAAcA,EAAY8B,gBADa,mBAC3ElT,EAD2E,KAChEC,EADgE,KAkBlF,OAfA5F,qBAAU,WAGR,GAFA4F,IAAamR,GAAcA,EAAY8B,gBAEnC9B,EAAa,CACf,IAAMlR,EAAa,kBAAMD,GAAa,IAChCE,EAAc,kBAAMF,GAAa,IAGvC,OAFAmR,EAAY7W,GAAG,eAAgB2F,GAC/BkR,EAAY7W,GAAG,gBAAiB4F,GACzB,WACLiR,EAAY5W,IAAI,eAAgB0F,GAChCkR,EAAY5W,IAAI,gBAAiB2F,OAGpC,CAACiR,IAEGpR,EF4DgBmT,CAA6BR,GAC9CvR,EAAiBgS,QAAQR,GACzBS,EAAuBpC,EAAalR,MAAK,SAAAwR,GAAC,MAAoB,WAAhBA,EAAExP,aAGhDoQ,EAAqBX,GADRK,GAASe,IAGtBxT,EAAUR,KAEhB,OACE,yBACEgB,UAAWsF,YAAK9F,EAAQwE,UAAT,gBACZxE,EAAQ+S,mBAAqBA,IAEhC5S,QAASA,EACT+T,sBAAqB3Y,EAAY4X,UAEjC,yBAAK3S,UAAWsF,YAAK9F,EAAQgT,cAAT,gBAA2BhT,EAAQkT,WAAalR,KAClE,yBAAKxB,UAAWR,EAAQoT,SACtB,wBAAI5S,UAAWR,EAAQmT,UACrB,kBAAC/B,GAAD,CAAgC7V,YAAaA,IAC5CA,EAAY4X,UAEf,kBAACrC,GAAD,CAAqBC,aAAc0C,KAErC,8BACIpS,GAAkB,kBAAC,IAAD,CAAQ8S,2BAAA,KAC1BnS,GAAkB,kBAAC,IAAD,MACnBiS,GAAwB,kBAAC,IAAD,MACxBX,GAAc,kBAAC7B,GAAD,QAGlBsB,GAAsB,kBAACvC,GAAD,MACtB3V,GG7GQ,SAASuZ,GAAT,GAAiD,IAA3BzY,EAA0B,EAA1BA,MAC7ByK,EAAMvI,iBAAyB,MAUrC,OARA5C,qBAAU,WACR,IAAMoL,EAAKD,EAAIrI,QAEf,OADApC,EAAM6K,OAAOH,GACN,WACL1K,EAAM8K,OAAOJ,MAEd,CAAC1K,IAEG,2BAAOyK,IAAKA,ICIN,SAASiO,GAAT,GAA+F,IAAxErC,EAAuE,EAAvEA,YAAa7L,EAA0D,EAA1DA,QAASmO,EAAiD,EAAjDA,aAAcC,EAAmC,EAAnCA,cAClE5Y,EAAQ8W,GAAST,GAEvB,IAAKrW,EAAO,OAAO,KAEnB,OAAQA,EAAMkD,MACZ,IAAK,QACH,OACE,kBAACqH,GAAD,CACEvK,MAAOA,EACPiD,SAAU2V,EACVpO,QAAwB,WAAfxK,EAAMe,MAAqByJ,IAG1C,IAAK,QACH,OAAOmO,EAAe,KAAO,kBAACF,GAAD,CAAYzY,MAAOA,IAClD,QACE,OAAO,MClBE,SAAS6Y,GAAT,GAKa,IAKtBC,EATJlZ,EAIyB,EAJzBA,YACA+Y,EAGyB,EAHzBA,aACAI,EAEyB,EAFzBA,kBACAH,EACyB,EADzBA,cAEQ3Z,EAASyE,IAATzE,KACFiX,EAAeD,GAAgBrW,GAC/B4K,EAAU5K,IAAgBX,EAAK8D,iBAUrC,OALE+V,EADEC,GAAqB7C,EAAa8C,MAAK,SAAAxC,GAAC,MAAoB,WAAhBA,EAAExP,aACzBkP,EAAa/U,QAAO,SAAAqV,GAAC,MAAoB,WAAhBA,EAAExP,aAE3BkP,EAAa/U,QAAO,SAAAqV,GAAC,MAAoB,WAAhBA,EAAExP,aAIlD,oCACG8R,EAAqBnL,KAAI,SAAA0I,GAAW,OACnC,kBAACqC,GAAD,CACEpD,IAAKe,EAAYnT,KACjBmT,YAAaA,EACbzW,YAAaA,EACb4K,QAASA,EACTmO,aAAcA,EACdC,cAAeA,QCnCV,SAASK,GAAT,GAMO,IALpBrZ,EAKmB,EALnBA,YACA+Y,EAImB,EAJnBA,aACAI,EAGmB,EAHnBA,kBACAvU,EAEmB,EAFnBA,QACAmT,EACmB,EADnBA,WAEA,OACE,kBAACD,GAAD,CAAiB9X,YAAaA,EAAa4E,QAASA,EAASmT,WAAYA,GACvE,kBAACkB,GAAD,CAAmBjZ,YAAaA,EAAa+Y,aAAcA,EAAcI,kBAAmBA,KClBnF,SAASG,KAAsB,IACpCja,EAASyE,IAATzE,KADmC,EAEGE,mBAASF,EAAKka,iBAFjB,mBAEpCA,EAFoC,KAEnBC,EAFmB,KA+B3C,OA3BA9Z,qBAAU,WAKR,IAAM+Z,EAA+B,SAACC,GACT,OAAvBA,GACFF,EAAmBE,IAMjBC,EAAgC,SAAC3Z,GACrCwZ,GAAmB,SAAAI,GACjB,OAAOA,IAAwB5Z,EAAc,KAAO4Z,MAMxD,OAFAva,EAAKO,GAAG,yBAA0B6Z,GAClCpa,EAAKO,GAAG,0BAA2B+Z,GAC5B,WACLta,EAAKQ,IAAI,yBAA0B4Z,GACnCpa,EAAKQ,IAAI,0BAA2B8Z,MAErC,CAACta,IAEGka,EC9BM,SAASM,KAAmB,IACjCxa,EAASyE,IAATzE,KACFka,EAAkBD,KAFgB,EAGA/Z,mBAASwH,MAAMC,KAAK3H,EAAK4H,aAAaC,WAHtC,mBAGjCD,EAHiC,KAGnB6S,EAHmB,KA8BxC,OAtBApa,qBAAU,WACJ6Z,GACFO,GAAgB,SAAAC,GAAgB,OAC9BR,GAD8B,oBAE3BQ,EAAiBxY,QAAO,SAAAvB,GAAW,OAAIA,IAAgBuZ,YAG7D,CAACA,IAEJ7Z,qBAAU,WACR,IAAMsa,EAAuB,SAACha,GAAD,OAC3B8Z,GAAgB,SAAAC,GAAgB,6BAAQA,GAAR,CAA0B/Z,QACtDia,EAA0B,SAACja,GAAD,OAC9B8Z,GAAgB,SAAAC,GAAgB,OAAIA,EAAiBxY,QAAO,SAAAqV,GAAC,OAAIA,IAAM5W,SAGzE,OAFAX,EAAKO,GAAG,uBAAwBoa,GAChC3a,EAAKO,GAAG,0BAA2Bqa,GAC5B,WACL5a,EAAKQ,IAAI,uBAAwBma,GACjC3a,EAAKQ,IAAI,0BAA2Boa,MAErC,CAAC5a,IAEG4H,EC5BT,IAAMkO,GAAY3K,YAAO,QAAPA,EAAgB,gBAAGrG,EAAH,EAAGA,MAAH,MAAgB,CAChDgF,SAAU,WACV+Q,IAAK,EACL5Q,OAAQ,EACRF,MAAM,eAAD,OAAiBjF,EAAMiT,aAAvB,OACL+C,KAAM,EACNzC,QAAS,QACT0C,UAAW,WAGE,SAASC,KAAoB,IAEhClX,EACNW,IADFzE,KAAQ8D,iBAEJ8D,EAAe4S,KAJoB,EAKa3a,IALb,mBAKlCM,EALkC,KAKb8a,EALa,KAOzC,OACE,kBAAC,GAAD,KACE,kBAACjB,GAAD,CACErZ,YAAamD,EACb4U,WAAYvY,IAAwB2D,EACpCyB,QAAS,kBAAM0V,EAAuBnX,MAEvC8D,EAAa8G,KAAI,SAAA/N,GAAW,OAC3B,kBAACqZ,GAAD,CACE3D,IAAK1V,EAAYua,IACjBva,YAAaA,EACb+X,WAAYvY,IAAwBQ,EACpC4E,QAAS,kBAAM0V,EAAuBta,UCzBhD,IAAMiE,GAAYC,YAAW,CAC3B+E,UAAW,CACTE,SAAU,WACVD,QAAS,OACToJ,WAAY,UAEdkF,mBAAoB,CAClB,UAAW,CACTjW,OAAQ,2CAGZqW,SAAU,CACRzF,WAAY,qBACZuF,QAAS,cACTpT,OAAQ,MACR4Q,SAAU,QACVhM,QAAS,cACT,QAAS,CACPoC,WAAY,UAGhBmM,cAAe,CACbtO,SAAU,WACVI,OAAQ,EACRtI,OAAQ,OACRyW,QAAS,QACTxW,MAAO,UASI,SAASsZ,GAAT,GAAmF,IAApDxa,EAAmD,EAAnDA,YAAaV,EAAsC,EAAtCA,SACnDmF,EAAUR,KAEVqS,EAAeD,GAAgBrW,GAC/BiY,EAAmB3B,EAAalR,MAAK,SAAAwR,GAAC,MAAoB,WAAhBA,EAAExP,aAC5CqT,EAAyBnE,EAAalR,MAAK,SAAAwR,GAAC,MAAoB,WAAhBA,EAAExP,aAClDX,EAAiBgS,QAAQR,GAGzBT,EAAqBX,GADRK,GAASuD,GAA0BxC,IAGtD,OACE,yBACEyC,4BAAA,EACAzV,UAAWsF,YAAK9F,EAAQwE,UAAT,gBAAuBxE,EAAQ+S,mBAAqBA,KAEnE,yBAAKvS,UAAWR,EAAQgT,eACtB,wBAAIxS,UAAWR,EAAQmT,UACpB5X,EAAY4X,UACXnR,GAAkB,kBAAC,IAAD,QAGvB+Q,GAAsB,kBAACvC,GAAD,MACtB3V,GChEQ,SAASqb,KACtB,IAAMC,ECAO,WAA2B,IAAD,EACT1b,IAAvBM,EADgC,oBAEjCmH,EAAyBD,IACzB6S,EAAkBD,KAClBrS,EAAe4S,KAEX1W,EACNW,IADFzE,KAAQ8D,iBAKV,OAAO3D,GAAuBmH,GAA0B4S,GAAmBtS,EAAa,IAAM9D,EDXtE0X,GACxB,OAGE,kBAACL,GAAD,CAAqBxa,YAAa4a,GAChC,kBAAC3B,GAAD,CAAmBjZ,YAAa4a,EAAiB7B,cAAY,EAACI,mBAAiB,EAACH,cAAc,WENpG,IAAM7D,GAAY3K,YAAO,MAAPA,CAAc,CAC9BrB,SAAU,WACVlI,OAAQ,SAGJ6Z,GAA2BtQ,YAAO,MAAPA,EAAc,kBAAgB,CAC7DrB,SAAU,WACVgR,KAF6C,EAAGhW,MAEpCiT,aACZhO,MAAO,EACP8Q,IAAK,EACL5Q,OAAQ,EACR,UAAW,CACTrI,OAAQ,YAIG,SAAS8Z,KACtB,OACE,kBAAC,GAAD,KACE,kBAACV,GAAD,MACA,kBAACS,GAAD,KACE,kBAACH,GAAD,QCfR,IAAMxF,GAAY3K,YAAO,MAAPA,CAAc,CAC9BtB,QAAS,OACT2L,cAAe,SACf5T,OAAQ,UAGJ+Z,GAAOxQ,YAAO,OAAPA,CAAe,CAC1BvJ,OAAQ,OACRkI,SAAU,aAGG,SAAS8R,KACtB,IAAMrR,EAAYd,KAElB,OACE,kBAAC,GAAD,KACE,kBAAC8J,GAAD,MACA,kBAACoI,GAAD,KACiB,iBAAdpR,EAA+B,kBAACuB,GAAD,MAAwB,kBAAC4P,GAAD,MACxD,kBAACpR,GAAD,OAEF,kBAAC2K,GAAD,O,aCOS4G,OAxBf,YAAoF,IAA7DC,EAA4D,EAA5DA,aAActZ,EAA8C,EAA9CA,MAA8C,EACvDA,GAAS,GAA3BG,EADyE,EACzEA,QAASoZ,EADgE,EAChEA,KACXC,ECfO,WAAsD,IAA9BrZ,EAA6B,uDAAnB,GAAIoZ,EAAe,uCAClE,OAAQA,GACN,KAAK,MACH,OAAOpZ,EAAU,4DACnB,QACE,OAAOA,GDUasZ,CAAetZ,EAASoZ,GAEhD,OACE,kBAAC7O,GAAA,EAAD,CAAQF,KAAgB,OAAVxK,EAAgByK,QAAS,kBAAM6O,KAAgB3O,WAAW,EAAMC,SAAS,MACrF,kBAACC,GAAA,EAAD,cACA,kBAACC,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,KAAoByO,GACnBD,GACC,6BACE,6CAAmBA,KAIzB,kBAAChO,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CAAQzI,QAAS,kBAAMuW,KAAgBjW,MAAM,UAAUoI,WAAS,GAAhE,S,oBE/BR,SAASiO,KAA2Q,OAA9PA,GAAWC,OAAOC,QAAU,SAAUxH,GAAU,IAAK,IAAIyH,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAASF,UAAUD,GAAI,IAAK,IAAIhG,KAAOmG,EAAcL,OAAOM,UAAUC,eAAeC,KAAKH,EAAQnG,KAAQzB,EAAOyB,GAAOmG,EAAOnG,IAAY,OAAOzB,IAA2BgI,MAAMC,KAAMP,WAEhT,SAASQ,GAAyBN,EAAQO,GAAY,GAAc,MAAVP,EAAgB,MAAO,GAAI,IAAkEnG,EAAKgG,EAAnEzH,EAEzF,SAAuC4H,EAAQO,GAAY,GAAc,MAAVP,EAAgB,MAAO,GAAI,IAA2DnG,EAAKgG,EAA5DzH,EAAS,GAAQoI,EAAab,OAAOc,KAAKT,GAAqB,IAAKH,EAAI,EAAGA,EAAIW,EAAWT,OAAQF,IAAOhG,EAAM2G,EAAWX,GAAQU,EAASG,QAAQ7G,IAAQ,IAAazB,EAAOyB,GAAOmG,EAAOnG,IAAQ,OAAOzB,EAFxMuI,CAA8BX,EAAQO,GAAuB,GAAIZ,OAAOiB,sBAAuB,CAAE,IAAIC,EAAmBlB,OAAOiB,sBAAsBZ,GAAS,IAAKH,EAAI,EAAGA,EAAIgB,EAAiBd,OAAQF,IAAOhG,EAAMgH,EAAiBhB,GAAQU,EAASG,QAAQ7G,IAAQ,GAAkB8F,OAAOM,UAAUa,qBAAqBX,KAAKH,EAAQnG,KAAgBzB,EAAOyB,GAAOmG,EAAOnG,IAAU,OAAOzB,EAMne,IAAI,GAEJ,IAAM2I,cAAc,QAAS,KAAM,+BAE/BC,GAEJ,IAAMD,cAAc,OAAQ,KAAM,wBAE9BE,GAEJ,IAAMF,cAAc,OAAQ,KAAM,IAAMA,cAAc,SAAU,CAC9DG,EAAG,OACHC,EAAG,OACH9b,MAAO,OACPD,OAAQ,OACRgc,YAAa,oBACbnJ,GAAI,YACH,IAAM8I,cAAc,WAAY,CACjCM,GAAI,EACJC,GAAI,EACJC,GAAI,cACJC,OAAQ,uBACN,IAAMT,cAAc,iBAAkB,CACxCU,aAAc,GACdF,GAAI,qBACJC,OAAQ,qBACN,IAAMT,cAAc,gBAAiB,CACvC1V,OAAQ,mDACRkW,GAAI,mBACJlJ,KAAM,SACNmJ,OAAQ,uBACN,IAAMT,cAAc,WAAY,CAClCM,GAAI,EACJC,GAAI,EACJC,GAAI,cACJC,OAAQ,uBACN,IAAMT,cAAc,iBAAkB,CACxCU,aAAc,GACdF,GAAI,qBACJC,OAAQ,qBACN,IAAMT,cAAc,gBAAiB,CACvC1V,OAAQ,mDACRkW,GAAI,mBACJlJ,KAAM,SACNmJ,OAAQ,uBACN,IAAMT,cAAc,UAAW,KAAM,IAAMA,cAAc,cAAe,CAC1EQ,GAAI,uBACF,IAAMR,cAAc,cAAe,CACrCQ,GAAI,uBACF,IAAMR,cAAc,cAAe,CACrCQ,GAAI,oBACA,IAAMR,cAAc,OAAQ,CAChC9I,GAAI,SACJiJ,EAAG,EACHC,EAAG,EACH9b,MAAO,GACPD,OAAQ,GACRsc,GAAI,KAGFC,GAEJ,IAAMZ,cAAc,IAAK,CACvB9I,GAAI,gBACJwD,OAAQ,OACRC,YAAa,EACbkG,KAAM,OACNC,SAAU,WACT,IAAMd,cAAc,IAAK,CAC1B9I,GAAI,UACJzK,UAAW,wCACT,IAAMuT,cAAc,IAAK,CAC3B9I,GAAI,0BACJzK,UAAW,mCACV,IAAMuT,cAAc,IAAK,CAC1B9I,GAAI,oBACJzK,UAAW,mCACV,IAAMuT,cAAc,OAAQ,CAC7Be,EAAG,kTACH7J,GAAI,QACJ2J,KAAM,YACJ,IAAMb,cAAc,OAAQ,CAC9Be,EAAG,0SACH7J,GAAI,QACJ2J,KAAM,YACJ,IAAMb,cAAc,OAAQ,CAC9Be,EAAG,0TACH7J,GAAI,QACJ2J,KAAM,YACJ,IAAMb,cAAc,OAAQ,CAC9Be,EAAG,ySACH7J,GAAI,QACJ2J,KAAM,YACJ,IAAMb,cAAc,OAAQ,CAC9Be,EAAG,iCACH7J,GAAI,WACD,IAAM8I,cAAc,IAAK,CAC5B9I,GAAI,qBAGF,GAAgB,SAAuB8J,GACzC,IAAIC,EAASD,EAAKC,OACdlZ,EAAQiZ,EAAKjZ,MACbkB,EAAQsW,GAAyByB,EAAM,CAAC,SAAU,UAEtD,OAAO,IAAMhB,cAAc,MAAOrB,GAAS,CACzCra,MAAO,OACPD,OAAQ,OACR6c,QAAS,YACTjT,IAAKgT,GACJhY,QAAkBlF,IAAVgE,EAAsB,GAAQA,EAAQ,IAAMiY,cAAc,QAAS,KAAMjY,GAAS,KAAMkY,GAAOC,GAAOU,KAG/GO,GAAa,IAAMC,YAAW,SAAUnY,EAAOgF,GACjD,OAAO,IAAM+R,cAAc,GAAerB,GAAS,CACjDsC,OAAQhT,GACPhF,OAEU,IC9Hf,SAAS,KAA2Q,OAA9P,GAAW2V,OAAOC,QAAU,SAAUxH,GAAU,IAAK,IAAIyH,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAASF,UAAUD,GAAI,IAAK,IAAIhG,KAAOmG,EAAcL,OAAOM,UAAUC,eAAeC,KAAKH,EAAQnG,KAAQzB,EAAOyB,GAAOmG,EAAOnG,IAAY,OAAOzB,IAA2BgI,MAAMC,KAAMP,WAEhT,SAAS,GAAyBE,EAAQO,GAAY,GAAc,MAAVP,EAAgB,MAAO,GAAI,IAAkEnG,EAAKgG,EAAnEzH,EAEzF,SAAuC4H,EAAQO,GAAY,GAAc,MAAVP,EAAgB,MAAO,GAAI,IAA2DnG,EAAKgG,EAA5DzH,EAAS,GAAQoI,EAAab,OAAOc,KAAKT,GAAqB,IAAKH,EAAI,EAAGA,EAAIW,EAAWT,OAAQF,IAAOhG,EAAM2G,EAAWX,GAAQU,EAASG,QAAQ7G,IAAQ,IAAazB,EAAOyB,GAAOmG,EAAOnG,IAAQ,OAAOzB,EAFxM,CAA8B4H,EAAQO,GAAuB,GAAIZ,OAAOiB,sBAAuB,CAAE,IAAIC,EAAmBlB,OAAOiB,sBAAsBZ,GAAS,IAAKH,EAAI,EAAGA,EAAIgB,EAAiBd,OAAQF,IAAOhG,EAAMgH,EAAiBhB,GAAQU,EAASG,QAAQ7G,IAAQ,GAAkB8F,OAAOM,UAAUa,qBAAqBX,KAAKH,EAAQnG,KAAgBzB,EAAOyB,GAAOmG,EAAOnG,IAAU,OAAOzB,EAMne,IAAI,GAEJ,IAAM2I,cAAc,OAAQ,CAC1Be,EAAG,y9CAGD,GAAgB,SAAuBC,GACzC,IAAIC,EAASD,EAAKC,OACdlZ,EAAQiZ,EAAKjZ,MACbkB,EAAQ,GAAyB+X,EAAM,CAAC,SAAU,UAEtD,OAAO,IAAMhB,cAAc,MAAO,GAAS,CACzCa,KAAM,UACNK,QAAS,aACTjT,IAAKgT,GACJhY,GAAQlB,EAAQ,IAAMiY,cAAc,QAAS,KAAMjY,GAAS,KAAM,KAGnE,GAAa,IAAMqZ,YAAW,SAAUnY,EAAOgF,GACjD,OAAO,IAAM+R,cAAc,GAAe,GAAS,CACjDiB,OAAQhT,GACPhF,O,IAEU,I,6BCdT5B,GAAYC,YAAW,CAC3B+E,UAAW,CACThI,OAAQ,QACRkR,WAAY,WAEd8L,WAAY,CACV/c,MAAO,MACPgI,QAAS,SAEXgV,UAAW,CACThd,MAAO,MACPwW,QAAS,iBAEXyG,MAAO,CACLjV,QAAS,OACToJ,WAAY,SACZuC,cAAe,SACf6C,QAAS,MACT0G,UAAW,MACXjM,WAAY,QACZjN,MAAO,SAETmZ,OAAQ,CACNnZ,MAAO,QACPiN,WAAY,QACZ7N,OAAQ,gBACRga,cAAe,QAEjBC,aAAc,CACZrZ,MAAO,MACPgE,QAAS,OACToJ,WAAY,SACZhO,OAAQ,cACR,QAAS,CACPkO,YAAa,YAKbrO,GAAQqa,aAAe,CAC3BtM,QAAS,CACPgC,KAAM,W,cCtDK,SAASuK,GAAT,GAA0D,IAAlCnf,EAAiC,EAAjCA,SAAaof,EAAoB,+BACxClN,KAAtBpB,EAD8D,EAC9DA,YAEFuO,EAHgE,EACjDlR,OAEWR,8CAAY2R,mBAE5C,OAAKD,GAAmBvO,EAKtB,kBAAC,KAAD,iBACMsO,EADN,CAEEG,OAAQ,gBAAGrO,EAAH,EAAGA,SAAH,OACNmO,EACErf,EAEA,kBAAC,KAAD,CACEwf,GAAI,CACF9N,SAAU,SACVnK,MAAO,CAAEG,KAAMwJ,UAblB,KCGIgO,oBAAe,CAC5BtM,QAAS,CACPgC,KAAM,OACN6K,QAAS,CACPC,KAAM,YAGV5H,aAAc,MCDV6H,GAAoC,CACxCC,iBAAkB,CAChBnX,MAAO,CACLoX,KAAM,gBACNC,iBAAkB,CAChBC,KAAM,CAAEpe,OAAQ,KAAMC,MAAO,MAC7Boe,SAAU,CAAEre,OAAQ,GAAIC,MAAO,KAC/Bqe,IAAK,CAAEte,OAAQ,GAAIC,MAAO,QAIhCqY,iBAAiB,EACjBiG,gBAAiB,KACjBC,eAAgB,CAAEC,MAAO,EAAGC,OAAQ,GACpCC,qBAAsB,CAAC,CAAEC,MAAO,MAAOC,WAAW,KAG9CC,GAAW,WAAO,IAAD,EACOvO,KAApB3P,EADa,EACbA,MAAOme,EADM,EACNA,SAEf,OACE,kBAACve,EAAD,CAAeC,QAASud,GAAmBtd,QAASqe,GAClD,kBAAC,GAAD,CAAa7E,aAAc,kBAAM6E,EAAS,OAAOne,MAAOA,IACxD,kBAACoZ,GAAD,QAKNgF,IAASpB,OACP,kBAAC,IAAD,CAAkB1a,MAAOA,IACvB,kBAAC+b,EAAA,EAAD,MACA,kBAAC,KAAD,KACE,mBlCxBS,SAA0Bra,GAAqC,IAAD,EACjDtG,mBAA6B,MADoB,mBACpEsC,EADoE,KAC7Dme,EAD6D,KAEvEG,EAAe,CACjBte,QACAme,YAgCF,OA5BEG,EADqC,aAAnClT,8CAAY2R,mBACF,eACPuB,EADO,GFvBD,WAA4B,IAAD,EAChB5gB,mBAA+B,MADf,mBACjCkO,EADiC,KAC3B0C,EAD2B,OAEF5Q,oBAAS,GAFP,mBAEjC6Q,EAFiC,KAEpBC,EAFoB,KAIlCC,EAAWxP,sBAAW,yCAC1B,WAAO8W,EAAkB5E,GAAzB,sBAAAtD,EAAA,6DACQR,EAAU,IAAInM,OAAOqd,QAD7B,SAGwB3S,EAAM4S,aAH9B,cAGQC,EAHR,OAIEpR,EAAQqR,IAAI,gBAAiBD,GAEvBE,EAAWvT,8CAAYwT,0BAA4B,SACnDC,EAAS,IAAI3d,OAAO4d,gBAAgB,CAAE/I,WAAU5E,aAPxD,kBASShE,MAAM,GAAD,OAAIwR,EAAJ,YAAgBE,GAAU,CAAExR,YAAW1O,MAAK,SAAAiP,GAAG,OAAIA,EAAIzB,WATrE,2CAD0B,wDAY1B,CAACP,IAGH/N,qBAAU,WACRkhB,iBAAuBzS,IACvByS,UAAgBC,oBAAmB,SAAApT,GACjC0C,EAAQ1C,GACR4C,GAAe,QAEhB,IAEH,IAAMY,EAASnQ,uBAAY,WACzB,IAAMggB,EAAW,IAAIF,QAAcG,mBAGnC,OAFAD,EAASE,SAAS,8CAEXJ,UAEJK,gBAAgBH,GAChBtgB,MAAK,SAAAiN,GACJ0C,EAAQ1C,EAAKA,WAEhB,IAEG0D,EAAUrQ,uBAAY,WAC1B,OAAO8f,UAEJzP,UACA3Q,MAAK,WACJ2P,EAAQ,WAEX,IAEH,MAAO,CAAE1C,OAAMwD,SAAQE,UAASf,cAAaE,YEvBtC4Q,IAEuC,aAAnCjU,8CAAY2R,mBACT,eACPuB,EADO,GAEPnQ,MAGO,eACPmQ,EADO,CAEV7P,SAAS,WAAD,8BAAE,WAAOsH,EAAU5E,GAAjB,oBAAAtD,EAAA,6DACFR,EAAU,IAAInM,OAAOqd,QACrBI,EAAWvT,8CAAYwT,0BAA4B,SACnDC,EAAS,IAAI3d,OAAO4d,gBAAgB,CAAE/I,WAAU5E,aAH9C,kBAKDhE,MAAM,GAAD,OAAIwR,EAAJ,YAAgBE,GAAU,CAAExR,YAAW1O,MAAK,SAAAiP,GAAG,OAAIA,EAAIzB,WAL3D,2CAAF,qDAAC,KAgBN,kBAACuD,GAAazR,SAAd,CAAuBC,MAAK,eAAOogB,EAAP,CAAqB7P,SANT,SAACnP,EAAM9B,GAAP,OAC7C8gB,EAAa7P,SAASnP,EAAM9B,GAAM+I,OAAM,SAAA+Y,GAEtC,OADAnB,EAASmB,GACF9P,QAAQ+P,OAAOD,UAG2Ctb,EAAMvG,YkCZvE,KACE,kBAAC,KAAD,KACE,kBAACmf,GAAD,CAAc4C,OAAK,EAACC,KAAK,KACvB,kBAAC,GAAD,OAEF,kBAAC7C,GAAD,CAAc6C,KAAK,sBACjB,kBAAC,GAAD,OAEF,kBAAC,KAAD,CAAOA,KAAK,UACV,mBHEG,WACb,IAAM7c,EAAUR,KADkB,EAEIuN,KAA9BP,EAF0B,EAE1BA,OAAQxD,EAFkB,EAElBA,KAAM2C,EAFY,EAEZA,YAChBH,EAAUC,eACVM,EAAW+Q,eAJiB,EAKFhiB,mBAAS,IALP,mBAK3BwP,EAL2B,KAKjByS,EALiB,OAMAjiB,mBAAuB,MANvB,mBAM3BkiB,EAN2B,KAMhBC,EANgB,KAQ5BC,EAAgBlJ,QAAQxL,8CAAY2R,oBAEpCgD,EAAQ,WACZF,EAAa,MACP,OAANzQ,QAAM,IAANA,KAASlC,GACNvO,MAAK,WAAO,IAAD,EACVyP,EAAQc,SAAgB,OAARP,QAAQ,IAARA,OAAA,YAAAA,EAAU3J,aAAV,eAAiBG,OAAQ,CAAEgK,SAAU,SAEtD5I,OAAM,SAAA+Y,GAAG,OAAIO,EAAaP,OAY/B,OAJI1T,GAASkU,GACX1R,EAAQc,QAAQ,KAGbX,EAKH,kBAACyR,EAAA,EAAD,CAAe1d,MAAOA,IACpB,kBAAC2d,GAAA,EAAD,CAAM7Y,WAAS,EAAC8Y,QAAQ,SAASzP,WAAW,aAAarN,UAAWR,EAAQwE,WAC1E,kBAAC+Y,GAAA,EAAD,CAAO/c,UAAWR,EAAQ0Z,MAAO8D,UAAW,GAC1C,kBAAC,GAAD,CAAYhd,UAAWR,EAAQwZ,aAC/B,yBAAKhZ,UAAWR,EAAQyZ,UAAWrQ,IAAKqQ,KAAWgE,IAAI,eAEnB,aAAnCjV,8CAAY2R,oBACX,kBAACvR,GAAA,EAAD,CAAQuG,QAAQ,YAAY3O,UAAWR,EAAQ4Z,OAAQzZ,QAASgd,EAAOO,UAAW,kBAAC,GAAD,OAAlF,uBAKkC,aAAnClV,8CAAY2R,oBACX,0BAAMxL,SA3BK,SAACgP,GACpBA,EAAE9O,iBACFsO,MA0BU,kBAACE,GAAA,EAAD,CAAM7Y,WAAS,EAACqJ,WAAW,SAAS+P,UAAU,UAC5C,kBAACxO,GAAA,EAAD,CACEC,GAAG,iBACHC,MAAM,WACNC,SAAU,SAACoO,GAAD,OAAsCZ,EAAYY,EAAEnO,OAAOlU,QACrEmU,KAAK,aAEP,6BACGuN,GACC,kBAAC9N,GAAA,EAAD,CAAYC,QAAQ,UAAU3O,UAAWR,EAAQ8Z,cAC/C,kBAAC,KAAD,MACCkD,EAAUzf,UAIjB,kBAACqL,GAAA,EAAD,CAAQuG,QAAQ,YAAY3O,UAAWR,EAAQ4Z,OAAQnK,KAAK,SAASlO,UAAW+I,EAAS6M,QAAzF,eAjCL,OG/BC,OAEF,kBAAC,KAAD,CAAUkD,GAAG,UAKrB9S,SAASsW,eAAe,W","file":"static/js/main.1bbd5e05.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZIAAAEyCAYAAADQnlYUAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFdElEQVR42u3dwW3DUAxEQSnI2a2oCxXtLtyKGlB68BrZMH+mAoGH/8CLuF/HeW8AC3u8nrspvO/LCAAQEgAqruO8hQSAtyNiIwEgioiQABBFREgAiCIiJABEERESAKKICAkAUUSEBIAoIkICQBQRIQEgioiQABBFREgAiCIiJABEERESAKKICAkAW3rg8PuTH+PKGDDl8eNzc7SRAIiIkADQ2+iEBEBEhASATkSEBEBEhASAXkSEBEBEhASAXkSEBEBEhASAXkSEBEBEhASAXkSEBEBEhASA7t+QhQRARIQEQESEBICBERESABEREgARERIAhkZESABEREgARERIABgaESEBEBEhARARIQFgaESEBEBEhARARIQEgKERERKARSPyeD13IQEQkXpEhARARIQEQER6ERESABEREgAR6UVESABEREgARKQXESEBEBEhARCRXkSEBEBEhARARHoRERIAERESABHpRURIAERESABEREgARGRoRIQEQESEBEBEhARARIZGREgARERIAERESABEZGhEhARARIQEQESEBEBEhkZESABEREgARERIAERkaESEBEBEhARARIQEQESEBEBEVoyIkACIiJAATPLfIiIkACIiJAAiIiQAIiIkAKwYESEBEBEhARARIQEQESEBYMWICAmAiAgJgIgICYCICAmAiAgJACIiJAAiIiQAIiIkACIiJACIiJAAiIiQAIiIkACIiJAAiAhCAiAiQgIgIkICICJCAiAiCAmAiAgJgIgICYCICAmAiAgJgIggJAAiIiQAIiIkACIiJAAigpAAiIiQAIiIkACIiJAAiAhCAogIQgIgIkICICJCAiAiCAkgIggJgIj8Fd9GAAgINhIAhAQAIQFASABASAAQEgCEBAAhAQAhAUBIABASAIQEAIQEACEBQEgAEBIAEBIAhAQAIQFASAAQEgAQEgCEBAAhAUBIAEBIABASAIQEACEBACEBQEgAEBIAhAQAhAQAIQFASAAQEgCEBACEBAAhAUBIABASABASAIQEACEBQEgAQEgAEBIAhAQAIQEAIQFASAAQEoDQdZz3dZy3SQgJQBwUUxASADEREgAxERIAMUFIADEREyEBEBMhARATIQEQE4QEQEyEBEBMhARATIQEQEwQEgAxERIAMRESADEREgAxQUgAxERIAMRESADEREgAxERIABATIQEQEyEBEBMhARATIQFATIQEQEyEBEBMhARATIQEADEREgAxERIAMRESADEREgDEREgAxERIAMRESADEREgAWDsmQgIgJkICICZCAiAmQgLAijEREgAxERIAMRESADEREgBWjImQAGzb9ng9dzEREgAxERIAMRESADFZKiZCAiAmQgIgJkICICZDYyIkAGIiJABiIiQAYjI0JkICICZCAiAmQgIgJkNjIiQAYiIkAGIiJABiMjQmQgIgJkICICZCAiAmQ2MiJABiIiQAYtKLiZAAiImQAIhJLyZCAiAmQgIgJr2YCAmAmAgJgJj0YiIkAGIiJABi0ouJkACIiZAAiEkvJkICICZCAiAmvZgICcCiMRESADEREgDmx0RIAMRESADEREgAGBoTIQEQEyEBEBMhAWBoTIQEQEyEBEBMhASAoTEREgAxERIAMRESAIbGREgAxERIAOjFREgAxERIAOjFREgAxERIAOjFREgAxERIAOjFREgAxERIAOjFREgAxERIAOjFREgAxERIAOjFZL+O8zZOwKP6926h/5a0AzYSABGNIiokAEQxERIAopgICQBRTIQEgCgmQgJAFBMhASCKiZAAEMVESACIYiIkAEQxERIAopgICQBRTIQEgCgmQgJAFBMhASCKiZAAEMVESACI/ACDMI238rqCJQAAAABJRU5ErkJggg==\"","import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { Participant, Room } from 'twilio-video';\r\n\r\ntype selectedParticipantContextType = [Participant | null, (participant: Participant) => void];\r\n\r\nexport const selectedParticipantContext = createContext<selectedParticipantContextType>(null!);\r\n\r\nexport default function useSelectedParticipant() {\r\n  const [selectedParticipant, setSelectedParticipant] = useContext(selectedParticipantContext);\r\n  return [selectedParticipant, setSelectedParticipant] as const;\r\n}\r\n\r\ntype SelectedParticipantProviderProps = {\r\n  room: Room;\r\n  children: React.ReactNode;\r\n};\r\n\r\nexport function SelectedParticipantProvider({ room, children }: SelectedParticipantProviderProps) {\r\n  const [selectedParticipant, _setSelectedParticipant] = useState<Participant | null>(null);\r\n  const setSelectedParticipant = (participant: Participant) =>\r\n    _setSelectedParticipant(prevParticipant => (prevParticipant === participant ? null : participant));\r\n\r\n  useEffect(() => {\r\n    const onDisconnect = () => _setSelectedParticipant(null);\r\n    room.on('disconnected', onDisconnect);\r\n    return () => {\r\n      room.off('disconnected', onDisconnect);\r\n    };\r\n  }, [room]);\r\n\r\n  return (\r\n    <selectedParticipantContext.Provider value={[selectedParticipant, setSelectedParticipant]}>\r\n      {children}\r\n    </selectedParticipantContext.Provider>\r\n  );\r\n}\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport Video, { LocalVideoTrack, LocalAudioTrack } from 'twilio-video';\r\n\r\nexport function useLocalAudioTrack() {\r\n  const [track, setTrack] = useState<LocalAudioTrack>();\r\n\r\n  useEffect(() => {\r\n    Video.createLocalAudioTrack().then(newTrack => {\r\n      setTrack(newTrack);\r\n    });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const handleStopped = () => setTrack(undefined);\r\n    if (track) {\r\n      track.on('stopped', handleStopped);\r\n      return () => {\r\n        track.off('stopped', handleStopped);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return track;\r\n}\r\n\r\nexport function useLocalVideoTrack() {\r\n  const [track, setTrack] = useState<LocalVideoTrack>();\r\n\r\n  const getLocalVideoTrack = useCallback(\r\n    () =>\r\n      Video.createLocalVideoTrack({\r\n        frameRate: 24,\r\n        height: 720,\r\n        width: 1280,\r\n        name: 'camera',\r\n      }).then(newTrack => {\r\n        setTrack(newTrack);\r\n        return newTrack;\r\n      }),\r\n    []\r\n  );\r\n\r\n  useEffect(() => {\r\n    // We get a new local video track when the app loads.\r\n    getLocalVideoTrack();\r\n  }, [getLocalVideoTrack]);\r\n\r\n  useEffect(() => {\r\n    const handleStopped = () => setTrack(undefined);\r\n    if (track) {\r\n      track.on('stopped', handleStopped);\r\n      return () => {\r\n        track.off('stopped', handleStopped);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return [track, getLocalVideoTrack] as const;\r\n}\r\n\r\nexport default function useLocalTracks() {\r\n  const audioTrack = useLocalAudioTrack();\r\n  const [videoTrack, getLocalVideoTrack] = useLocalVideoTrack();\r\n\r\n  const localTracks = [audioTrack, videoTrack].filter(track => track !== undefined) as (\r\n    | LocalAudioTrack\r\n    | LocalVideoTrack\r\n  )[];\r\n\r\n  return { localTracks, getLocalVideoTrack };\r\n}\r\n","import React, { createContext, ReactNode } from 'react';\r\nimport { ConnectOptions, Room, TwilioError, LocalAudioTrack, LocalVideoTrack } from 'twilio-video';\r\nimport { Callback, ErrorCallback } from '../../types';\r\nimport { SelectedParticipantProvider } from './useSelectedParticipant/useSelectedParticipant';\r\n\r\nimport useHandleRoomDisconnectionErrors from './useHandleRoomDisconnectionErrors/useHandleRoomDisconnectionErrors';\r\nimport useHandleOnDisconnect from './useHandleOnDisconnect/useHandleOnDisconnect';\r\nimport useHandleTrackPublicationFailed from './useHandleTrackPublicationFailed/useHandleTrackPublicationFailed';\r\nimport useLocalTracks from './useLocalTracks/useLocalTracks';\r\nimport useRoom from './useRoom/useRoom';\r\n\r\n/*\r\n *  The hooks used by the VideoProvider component are different than the hooks found in the 'hooks/' directory. The hooks\r\n *  in the 'hooks/' directory can be used anywhere in a video application, and they can be used any number of times.\r\n *  the hooks in the 'VideoProvider/' directory are intended to be used by the VideoProvider component only. Using these hooks\r\n *  elsewhere in the application may cause problems as these hooks should not be used more than once in an application.\r\n */\r\n\r\nexport interface IVideoContext {\r\n  room: Room;\r\n  localTracks: (LocalAudioTrack | LocalVideoTrack)[];\r\n  isConnecting: boolean;\r\n  connect: (token: string) => Promise<void>;\r\n  onError: ErrorCallback;\r\n  onDisconnect: Callback;\r\n  getLocalVideoTrack: () => Promise<LocalVideoTrack>;\r\n}\r\n\r\nexport const VideoContext = createContext<IVideoContext>(null!);\r\n\r\ninterface VideoProviderProps {\r\n  options?: ConnectOptions;\r\n  onError: ErrorCallback;\r\n  onDisconnect?: Callback;\r\n  children: ReactNode;\r\n}\r\n\r\nexport function VideoProvider({ options, children, onError = () => {}, onDisconnect = () => {} }: VideoProviderProps) {\r\n  const onErrorCallback = (error: TwilioError) => {\r\n    console.log(`ERROR: ${error.message}`, error);\r\n    onError(error);\r\n  };\r\n\r\n  const { localTracks, getLocalVideoTrack } = useLocalTracks();\r\n  const { room, isConnecting, connect } = useRoom(localTracks, onErrorCallback, options);\r\n\r\n  // Register onError and onDisconnect callback functions.\r\n  useHandleRoomDisconnectionErrors(room, onError);\r\n  useHandleTrackPublicationFailed(room, onError);\r\n  useHandleOnDisconnect(room, onDisconnect);\r\n\r\n  return (\r\n    <VideoContext.Provider\r\n      value={{\r\n        room,\r\n        localTracks,\r\n        isConnecting,\r\n        onError: onErrorCallback,\r\n        onDisconnect,\r\n        getLocalVideoTrack,\r\n        connect,\r\n      }}\r\n    >\r\n      <SelectedParticipantProvider room={room}>{children}</SelectedParticipantProvider>\r\n    </VideoContext.Provider>\r\n  );\r\n}\r\n","import EventEmitter from 'events';\r\nimport { useCallback, useEffect, useRef, useState } from 'react';\r\nimport Video, { ConnectOptions, LocalTrack, Room } from 'twilio-video';\r\nimport { Callback } from '../../../types';\r\n\r\nexport default function useRoom(localTracks: LocalTrack[], onError: Callback, options?: ConnectOptions) {\r\n  const [room, setRoom] = useState<Room>(new EventEmitter() as Room);\r\n  const [isConnecting, setIsConnecting] = useState(false);\r\n  const disconnectHandlerRef = useRef<() => void>(() => {});\r\n  const localTracksRef = useRef<LocalTrack[]>([]);\r\n\r\n  useEffect(() => {\r\n    // It can take a moment for Video.connect to connect to a room. During this time, the user may have enabled or disabled their\r\n    // local audio or video tracks. If this happens, we store the localTracks in this ref, so that they are correctly published\r\n    // once the user is connected to the room.\r\n    localTracksRef.current = localTracks;\r\n  }, [localTracks]);\r\n\r\n  const connect = useCallback(\r\n    token => {\r\n      setIsConnecting(true);\r\n      return Video.connect(token, { ...options, tracks: [] }).then(\r\n        newRoom => {\r\n          setRoom(newRoom);\r\n\r\n          newRoom.once('disconnected', () => {\r\n            // Reset the room only after all other `disconnected` listeners have been called.\r\n            setTimeout(() => setRoom(new EventEmitter() as Room));\r\n            window.removeEventListener('beforeunload', disconnectHandlerRef.current);\r\n          });\r\n\r\n          // @ts-ignore\r\n          window.twilioRoom = newRoom;\r\n\r\n          localTracksRef.current.forEach(track =>\r\n            // Tracks can be supplied as arguments to the Video.connect() function and they will automatically be published.\r\n            // However, tracks must be published manually in order to set the priority on them.\r\n            // All video tracks are published with 'low' priority. This works because the video\r\n            // track that is displayed in the 'MainParticipant' component will have it's priority\r\n            // set to 'high' via track.setPriority()\r\n            newRoom.localParticipant.publishTrack(track, { priority: track.kind === 'video' ? 'low' : 'standard' })\r\n          );\r\n\r\n          disconnectHandlerRef.current = () => newRoom.disconnect();\r\n          setIsConnecting(false);\r\n\r\n          // Add a listener to disconnect from the room when a user closes their browser\r\n          window.addEventListener('beforeunload', disconnectHandlerRef.current);\r\n        },\r\n        error => {\r\n          onError(error);\r\n          setIsConnecting(false);\r\n        }\r\n      );\r\n    },\r\n    [options, onError]\r\n  );\r\n\r\n  return { room, isConnecting, connect };\r\n}\r\n","import { Room, TwilioError } from 'twilio-video';\r\nimport { useEffect } from 'react';\r\n\r\nimport { Callback } from '../../../types';\r\n\r\nexport default function useHandleRoomDisconnectionErrors(room: Room, onError: Callback) {\r\n  useEffect(() => {\r\n    const onDisconnected = (room: Room, error: TwilioError) => {\r\n      if (error) {\r\n        onError(error);\r\n      }\r\n    };\r\n\r\n    room.on('disconnected', onDisconnected);\r\n    return () => {\r\n      room.off('disconnected', onDisconnected);\r\n    };\r\n  }, [room, onError]);\r\n}\r\n","import { Room } from 'twilio-video';\r\nimport { useEffect } from 'react';\r\n\r\nimport { Callback } from '../../../types';\r\n\r\nexport default function useHandleTrackPublicationFailed(room: Room, onError: Callback) {\r\n  const { localParticipant } = room;\r\n  useEffect(() => {\r\n    if (localParticipant) {\r\n      localParticipant.on('trackPublicationFailed', onError);\r\n      return () => {\r\n        localParticipant.off('trackPublicationFailed', onError);\r\n      };\r\n    }\r\n  }, [localParticipant, onError]);\r\n}\r\n","import { useEffect } from 'react';\r\nimport { Room } from 'twilio-video';\r\nimport { Callback } from '../../../types';\r\n\r\nexport default function useHandleOnDisconnect(room: Room, onDisconnect: Callback) {\r\n  useEffect(() => {\r\n    room.on('disconnected', onDisconnect);\r\n    return () => {\r\n      room.off('disconnected', onDisconnect);\r\n    };\r\n  }, [room, onDisconnect]);\r\n}\r\n","import { useContext } from 'react';\r\nimport { VideoContext } from '../../components/VideoProvider';\r\n\r\nexport default function useVideoContext() {\r\n  const context = useContext(VideoContext);\r\n  if (!context) {\r\n    throw new Error('useVideoContext must be used within a VideoProvider');\r\n  }\r\n  return context;\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport CallEnd from '@material-ui/icons/CallEnd';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    fab: {\r\n      margin: theme.spacing(1),\r\n    },\r\n  })\r\n);\r\n\r\nexport default function EndCallButton() {\r\n  const classes = useStyles();\r\n  const { room } = useVideoContext();\r\n\r\n  return (\r\n    <Tooltip title={'End Call'} onClick={() => room.disconnect()} placement=\"top\" PopperProps={{ disablePortal: true }}>\r\n      <Fab className={classes.fab} color=\"primary\">\r\n        <CallEnd />\r\n      </Fab>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { LocalAudioTrack } from 'twilio-video';\r\nimport { useCallback } from 'react';\r\nimport useIsTrackEnabled from '../useIsTrackEnabled/useIsTrackEnabled';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nexport default function useLocalAudioToggle() {\r\n  const { localTracks } = useVideoContext();\r\n  const audioTrack = localTracks.find(track => track.kind === 'audio') as LocalAudioTrack;\r\n  const isEnabled = useIsTrackEnabled(audioTrack);\r\n\r\n  const toggleAudioEnabled = useCallback(() => {\r\n    if (audioTrack) {\r\n      audioTrack.isEnabled ? audioTrack.disable() : audioTrack.enable();\r\n    }\r\n  }, [audioTrack]);\r\n\r\n  return [isEnabled, toggleAudioEnabled] as const;\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { LocalAudioTrack, LocalVideoTrack, RemoteAudioTrack, RemoteVideoTrack } from 'twilio-video';\r\n\r\ntype TrackType = LocalAudioTrack | LocalVideoTrack | RemoteAudioTrack | RemoteVideoTrack | undefined;\r\n\r\nexport default function useIsTrackEnabled(track: TrackType) {\r\n  const [isEnabled, setIsEnabled] = useState(track ? track.isEnabled : true);\r\n\r\n  useEffect(() => {\r\n    setIsEnabled(track ? track.isEnabled : true);\r\n\r\n    if (track) {\r\n      const setEnabled = () => setIsEnabled(true);\r\n      const setDisabled = () => setIsEnabled(false);\r\n      track.on('enabled', setEnabled);\r\n      track.on('disabled', setDisabled);\r\n      return () => {\r\n        track.off('enabled', setEnabled);\r\n        track.off('disabled', setDisabled);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return isEnabled;\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Mic from '@material-ui/icons/Mic';\r\nimport MicOff from '@material-ui/icons/MicOff';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport useLocalAudioToggle from '../../../hooks/useLocalAudioToggle/useLocalAudioToggle';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    fab: {\r\n      margin: theme.spacing(1),\r\n    },\r\n  })\r\n);\r\n\r\nexport default function ToggleAudioButton(props: { disabled?: boolean }) {\r\n  const classes = useStyles();\r\n  const [isAudioEnabled, toggleAudioEnabled] = useLocalAudioToggle();\r\n\r\n  return (\r\n    <Tooltip\r\n      title={isAudioEnabled ? 'Mute Audio' : 'Unmute Audio'}\r\n      placement=\"top\"\r\n      PopperProps={{ disablePortal: true }}\r\n    >\r\n      <Fab className={classes.fab} onClick={toggleAudioEnabled} disabled={props.disabled} data-cy-audio-toggle>\r\n        {isAudioEnabled ? <Mic /> : <MicOff />}\r\n      </Fab>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport Videocam from '@material-ui/icons/Videocam';\r\nimport VideocamOff from '@material-ui/icons/VideocamOff';\r\n\r\nimport useLocalVideoToggle from '../../../hooks/useLocalVideoToggle/useLocalVideoToggle';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    fab: {\r\n      margin: theme.spacing(1),\r\n    },\r\n  })\r\n);\r\n\r\nexport default function ToggleVideoButton(props: { disabled?: boolean }) {\r\n  const classes = useStyles();\r\n  const [isVideoEnabled, toggleVideoEnabled] = useLocalVideoToggle();\r\n\r\n  return (\r\n    <Tooltip\r\n      title={isVideoEnabled ? 'Mute Video' : 'Unmute Video'}\r\n      placement=\"top\"\r\n      PopperProps={{ disablePortal: true }}\r\n    >\r\n      <Fab className={classes.fab} onClick={toggleVideoEnabled} disabled={props.disabled}>\r\n        {isVideoEnabled ? <Videocam /> : <VideocamOff />}\r\n      </Fab>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { LocalVideoTrack } from 'twilio-video';\r\nimport { useCallback } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nexport default function useLocalVideoToggle() {\r\n  const {\r\n    room: { localParticipant },\r\n    localTracks,\r\n    getLocalVideoTrack,\r\n  } = useVideoContext();\r\n  const videoTrack = localTracks.find(track => track.name === 'camera') as LocalVideoTrack;\r\n\r\n  const toggleVideoEnabled = useCallback(() => {\r\n    if (videoTrack) {\r\n      if (localParticipant) {\r\n        const localTrackPublication = localParticipant.unpublishTrack(videoTrack);\r\n        // TODO: remove when SDK implements this event. See: https://issues.corp.twilio.com/browse/JSDK-2592\r\n        localParticipant.emit('trackUnpublished', localTrackPublication);\r\n      }\r\n      videoTrack.stop();\r\n    } else {\r\n      getLocalVideoTrack().then((track: LocalVideoTrack) => {\r\n        if (localParticipant) {\r\n          localParticipant.publishTrack(track);\r\n        }\r\n      });\r\n    }\r\n  }, [videoTrack, localParticipant, getLocalVideoTrack]);\r\n\r\n  return [!!videoTrack, toggleVideoEnabled] as const;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nimport { Participant, TrackPublication } from 'twilio-video';\r\n\r\n/*\r\n  Returns the participant that is sharing their screen (if any). This hook assumes that only one participant\r\n  can share their screen at a time.\r\n*/\r\nexport default function useScreenShareParticipant() {\r\n  const { room } = useVideoContext();\r\n  const [screenShareParticipant, setScreenShareParticipant] = useState();\r\n\r\n  useEffect(() => {\r\n    if (room.state === 'connected') {\r\n      const updateScreenShareParticipant = () => {\r\n        setScreenShareParticipant(\r\n          Array.from<Participant>(room.participants.values())\r\n            // the screenshare participant could be the localParticipant\r\n            .concat(room.localParticipant)\r\n            .find((participant: Participant) =>\r\n              Array.from<TrackPublication>(participant.tracks.values()).find(track => track.trackName === 'screen')\r\n            )\r\n        );\r\n      };\r\n      updateScreenShareParticipant();\r\n\r\n      room.on('trackPublished', updateScreenShareParticipant);\r\n      room.on('trackUnpublished', updateScreenShareParticipant);\r\n      room.on('participantDisconnected', updateScreenShareParticipant);\r\n\r\n      // the room object does not emit 'trackPublished' events for the localParticipant,\r\n      // so we need to listen for them here.\r\n      room.localParticipant.on('trackPublished', updateScreenShareParticipant);\r\n      room.localParticipant.on('trackUnpublished', updateScreenShareParticipant);\r\n      return () => {\r\n        room.off('trackPublished', updateScreenShareParticipant);\r\n        room.off('trackUnpublished', updateScreenShareParticipant);\r\n        room.off('participantDisconnected', updateScreenShareParticipant);\r\n\r\n        room.localParticipant.off('trackPublished', updateScreenShareParticipant);\r\n        room.localParticipant.off('trackUnpublished', updateScreenShareParticipant);\r\n      };\r\n    }\r\n  }, [room]);\r\n\r\n  return screenShareParticipant;\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport Fab from '@material-ui/core/Fab';\r\nimport ScreenShare from '@material-ui/icons/ScreenShare';\r\nimport StopScreenShare from '@material-ui/icons/StopScreenShare';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\n\r\nimport useScreenShareToggle from '../../../hooks/useScreenShareToggle/useScreenShareToggle';\r\nimport useScreenShareParticipant from '../../../hooks/useScreenShareParticipant/useScreenShareParticipant';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport const SCREEN_SHARE_TEXT = 'Share Screen';\r\nexport const STOP_SCREEN_SHARE_TEXT = 'Stop Sharing Screen';\r\nexport const SHARE_IN_PROGRESS_TEXT = 'Cannot share screen when another user is sharing';\r\nexport const SHARE_NOT_SUPPORTED_TEXT = 'Screen sharing is not supported with this browser';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    fab: {\r\n      margin: theme.spacing(1),\r\n      '&[disabled]': {\r\n        color: 'rgba(225, 225, 225, 0.8)',\r\n        backgroundColor: 'rgba(175, 175, 175, 0.6);',\r\n      },\r\n    },\r\n  })\r\n);\r\n\r\nexport default function ToggleScreenShareButton(props: { disabled?: boolean }) {\r\n  const classes = useStyles();\r\n  const [isScreenShared, toggleScreenShare] = useScreenShareToggle();\r\n  const screenShareParticipant = useScreenShareParticipant();\r\n  const { room } = useVideoContext();\r\n  const disableScreenShareButton = screenShareParticipant && screenShareParticipant !== room.localParticipant;\r\n  const isScreenShareSupported = navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia;\r\n  const isDisabled = props.disabled || disableScreenShareButton || !isScreenShareSupported;\r\n\r\n  let tooltipMessage = SCREEN_SHARE_TEXT;\r\n\r\n  if (isScreenShared) {\r\n    tooltipMessage = STOP_SCREEN_SHARE_TEXT;\r\n  }\r\n\r\n  if (disableScreenShareButton) {\r\n    tooltipMessage = SHARE_IN_PROGRESS_TEXT;\r\n  }\r\n\r\n  if (!isScreenShareSupported) {\r\n    tooltipMessage = SHARE_NOT_SUPPORTED_TEXT;\r\n  }\r\n\r\n  return (\r\n    <Tooltip\r\n      title={tooltipMessage}\r\n      placement=\"top\"\r\n      PopperProps={{ disablePortal: true }}\r\n      style={{ cursor: isDisabled ? 'not-allowed' : 'pointer' }}\r\n    >\r\n      <div>\r\n        {/* The div element is needed because a disabled button will not emit hover events and we want to display\r\n          a tooltip when screen sharing is disabled */}\r\n        <Fab className={classes.fab} onClick={toggleScreenShare} disabled={isDisabled}>\r\n          {isScreenShared ? <StopScreenShare /> : <ScreenShare />}\r\n        </Fab>\r\n      </div>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { useState, useCallback, useRef } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\nimport { LogLevels, Track } from 'twilio-video';\r\n\r\ninterface MediaStreamTrackPublishOptions {\r\n  name?: string;\r\n  priority: Track.Priority;\r\n  logLevel: LogLevels;\r\n}\r\n\r\nexport default function useScreenShareToggle() {\r\n  const { room, onError } = useVideoContext();\r\n  const [isSharing, setIsSharing] = useState(false);\r\n  const stopScreenShareRef = useRef<() => void>(null!);\r\n\r\n  const shareScreen = useCallback(() => {\r\n    navigator.mediaDevices\r\n      .getDisplayMedia({\r\n        audio: false,\r\n        video: {\r\n          frameRate: 10,\r\n          height: 1080,\r\n          width: 1920,\r\n        },\r\n      })\r\n      .then(stream => {\r\n        const track = stream.getTracks()[0];\r\n\r\n        // All video tracks are published with 'low' priority. This works because the video\r\n        // track that is displayed in the 'MainParticipant' component will have it's priority\r\n        // set to 'high' via track.setPriority()\r\n        room.localParticipant\r\n          .publishTrack(track, {\r\n            name: 'screen', // Tracks can be named to easily find them later\r\n            priority: 'high',\r\n          } as MediaStreamTrackPublishOptions)\r\n          .then(trackPublication => {\r\n            stopScreenShareRef.current = () => {\r\n              room.localParticipant.unpublishTrack(track);\r\n              // TODO: remove this if the SDK is updated to emit this event\r\n              room.localParticipant.emit('trackUnpublished', trackPublication);\r\n              track.stop();\r\n              setIsSharing(false);\r\n            };\r\n\r\n            track.onended = stopScreenShareRef.current;\r\n            setIsSharing(true);\r\n          })\r\n          .catch(onError);\r\n      })\r\n      .catch(error => {\r\n        // Don't display an error if the user closes the screen share dialog\r\n        if (error.name !== 'AbortError' && error.name !== 'NotAllowedError') {\r\n          onError(error);\r\n        }\r\n      });\r\n  }, [room, onError]);\r\n\r\n  const toggleScreenShare = useCallback(() => {\r\n    !isSharing ? shareScreen() : stopScreenShareRef.current();\r\n  }, [isSharing, shareScreen, stopScreenShareRef]);\r\n\r\n  return [isSharing, toggleScreenShare] as const;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\ntype RoomStateType = 'disconnected' | 'connected' | 'reconnecting';\r\n\r\nexport default function useRoomState() {\r\n  const { room } = useVideoContext();\r\n  const [state, setState] = useState<RoomStateType>('disconnected');\r\n\r\n  useEffect(() => {\r\n    const setRoomState = () => setState((room.state || 'disconnected') as RoomStateType);\r\n    setRoomState();\r\n    room\r\n      .on('disconnected', setRoomState)\r\n      .on('reconnected', setRoomState)\r\n      .on('reconnecting', setRoomState);\r\n    return () => {\r\n      room\r\n        .off('disconnected', setRoomState)\r\n        .off('reconnected', setRoomState)\r\n        .off('reconnecting', setRoomState);\r\n    };\r\n  }, [room]);\r\n\r\n  return state;\r\n}\r\n","import React from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport clsx from 'clsx';\r\n\r\nimport EndCallButton from './EndCallButton/EndCallButton';\r\nimport ToggleAudioButton from './ToggleAudioButton/ToggleAudioButton';\r\nimport ToggleVideoButton from './ToggleVideoButton/ToggleVideoButton';\r\nimport ToggleScreenShareButton from './ToogleScreenShareButton/ToggleScreenShareButton';\r\n\r\nimport useIsUserActive from './useIsUserActive/useIsUserActive';\r\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    container: {\r\n      display: 'flex',\r\n      position: 'absolute',\r\n      right: '50%',\r\n      transform: 'translate(50%, 30px)',\r\n      bottom: '50px',\r\n      zIndex: 1,\r\n      transition: 'opacity 1.2s, transform 1.2s, visibility 0s 1.2s',\r\n      opacity: 0,\r\n      visibility: 'hidden',\r\n      '&.showControls, &:hover': {\r\n        transition: 'opacity 0.6s, transform 0.6s, visibility 0s',\r\n        opacity: 1,\r\n        visibility: 'visible',\r\n        transform: 'translate(50%, 0px)',\r\n      },\r\n    },\r\n  })\r\n);\r\n\r\nexport default function Controls() {\r\n  const classes = useStyles();\r\n  const roomState = useRoomState();\r\n  const isReconnecting = roomState === 'reconnecting';\r\n  const isUserActive = useIsUserActive();\r\n  const showControls = isUserActive || roomState === 'disconnected';\r\n\r\n  return (\r\n    <div className={clsx(classes.container, { showControls })}>\r\n      <ToggleAudioButton disabled={isReconnecting} />\r\n      <ToggleVideoButton disabled={isReconnecting} />\r\n      {roomState !== 'disconnected' && (\r\n        <>\r\n          <ToggleScreenShareButton disabled={isReconnecting} />\r\n          <EndCallButton />\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","import { useEffect, useRef, useState } from 'react';\r\nimport throttle from 'lodash.throttle';\r\n\r\nexport default function useIsUserActive() {\r\n  const [isUserActive, setIsUserActive] = useState(true);\r\n  const timeoutIDRef = useRef(0);\r\n\r\n  useEffect(() => {\r\n    const handleUserActivity = throttle(() => {\r\n      setIsUserActive(true);\r\n      clearTimeout(timeoutIDRef.current);\r\n      const timeoutID = window.setTimeout(() => setIsUserActive(false), 5000);\r\n      timeoutIDRef.current = timeoutID;\r\n    }, 500);\r\n\r\n    handleUserActivity();\r\n\r\n    window.addEventListener('mousemove', handleUserActivity);\r\n    window.addEventListener('click', handleUserActivity);\r\n    window.addEventListener('keydown', handleUserActivity);\r\n    return () => {\r\n      window.removeEventListener('mousemove', handleUserActivity);\r\n      window.removeEventListener('click', handleUserActivity);\r\n      window.removeEventListener('keydown', handleUserActivity);\r\n      clearTimeout(timeoutIDRef.current);\r\n    };\r\n  }, []);\r\n\r\n  return isUserActive;\r\n}\r\n","import React, { useRef, useEffect } from 'react';\r\nimport { IVideoTrack } from '../../types';\r\nimport { styled } from '@material-ui/core/styles';\r\nimport { Track } from 'twilio-video';\r\n\r\nconst Video = styled('video')({\r\n  width: '100%',\r\n  maxHeight: '100%',\r\n  objectFit: 'contain',\r\n});\r\n\r\ninterface VideoTrackProps {\r\n  track: IVideoTrack;\r\n  isLocal?: boolean;\r\n  priority?: Track.Priority;\r\n}\r\n\r\nexport default function VideoTrack({ track, isLocal, priority }: VideoTrackProps) {\r\n  const ref = useRef<HTMLVideoElement>(null!);\r\n\r\n  useEffect(() => {\r\n    const el = ref.current;\r\n    el.muted = true;\r\n    if (track.setPriority && priority) {\r\n      track.setPriority(priority);\r\n    }\r\n    track.attach(el);\r\n    return () => {\r\n      track.detach(el);\r\n      if (track.setPriority && priority) {\r\n        // Passing `null` to setPriority will set the track's priority to that which it was published with.\r\n        track.setPriority(null);\r\n      }\r\n    };\r\n  }, [track, priority]);\r\n\r\n  // The local video track is mirrored.\r\n  const style = isLocal ? { transform: 'rotateY(180deg)' } : {};\r\n\r\n  return <Video ref={ref} style={style} />;\r\n}\r\n","import React from 'react';\r\nimport { LocalVideoTrack } from 'twilio-video';\r\nimport VideoTrack from '../VideoTrack/VideoTrack';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport default function LocalVideoPreview() {\r\n  const { localTracks } = useVideoContext();\r\n\r\n  const videoTrack = localTracks.find(track => track.name === 'camera') as LocalVideoTrack;\r\n\r\n  return videoTrack ? <VideoTrack track={videoTrack} isLocal /> : null;\r\n}\r\n","import React from 'react';\r\nimport { styled } from '@material-ui/core/styles';\r\n\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport useFullScreenToggle from '../../hooks/useFullScreenToggle/useFullScreenToggle';\r\n\r\nconst FullscreenButton = styled(IconButton)({\r\n  marginLeft: 'auto',\r\n});\r\n\r\nexport default function ToggleFullscreenButton() {\r\n  const [isFullScreen, toggleFullScreen] = useFullScreenToggle();\r\n\r\n  return (\r\n    <FullscreenButton aria-label={`full screen`} onClick={toggleFullScreen}>\r\n      {isFullScreen ? <FullscreenExitIcon /> : <FullscreenIcon />}\r\n    </FullscreenButton>\r\n  );\r\n}\r\n","import { useCallback, useState, useEffect } from 'react';\r\nimport fscreen from 'fscreen';\r\n\r\nexport default function useFullScreenToggle() {\r\n  const [isFullScreen, setIsFullScreen] = useState<Boolean>(!!fscreen.fullscreenElement);\r\n\r\n  useEffect(() => {\r\n    const onFullScreenChange = () => setIsFullScreen(!!fscreen.fullscreenElement);\r\n    fscreen.addEventListener('fullscreenchange', onFullScreenChange);\r\n    return () => {\r\n      fscreen.removeEventListener('fullscreenchange', onFullScreenChange);\r\n    };\r\n  }, []);\r\n\r\n  const toggleFullScreen = useCallback(() => {\r\n    isFullScreen ? fscreen.exitFullscreen() : fscreen.requestFullscreen(document.documentElement);\r\n  }, [isFullScreen]);\r\n\r\n  return [isFullScreen, toggleFullScreen] as const;\r\n}\r\n","import React, { PropsWithChildren } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\n\r\nimport { version as appVersion } from '../../../../package.json';\r\nimport Video from 'twilio-video';\r\n\r\ninterface AboutDialogProps {\r\n  open: boolean;\r\n  onClose(): void;\r\n}\r\n\r\nfunction AboutDialog({ open, onClose }: PropsWithChildren<AboutDialogProps>) {\r\n  return (\r\n    <Dialog open={open} onClose={onClose} fullWidth={true} maxWidth=\"xs\">\r\n      <DialogTitle>About:</DialogTitle>\r\n      <DialogContent>\r\n        <DialogContentText>Browser supported: {String(Video.isSupported)}</DialogContentText>\r\n        <DialogContentText>SDK Version: {Video.version}</DialogContentText>\r\n        <DialogContentText>App Version: {appVersion}</DialogContentText>\r\n        <DialogContentText>Deployed Tag: {process.env.REACT_APP_GIT_TAG || 'N/A'}</DialogContentText>\r\n        <DialogContentText>Deployed Commit Hash: {process.env.REACT_APP_GIT_COMMIT || 'N/A'}</DialogContentText>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={onClose} color=\"primary\" autoFocus>\r\n          OK\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default AboutDialog;\r\n","import React from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport makeStyles from '@material-ui/styles/makeStyles';\r\nimport Person from '@material-ui/icons/Person';\r\nimport { StateContextType } from '../../../state';\r\n\r\nconst useStyles = makeStyles({\r\n  red: {\r\n    color: 'white',\r\n    backgroundColor: '#F22F46',\r\n  },\r\n});\r\n\r\nexport function getInitials(name: string) {\r\n  return name\r\n    .split(' ')\r\n    .map(text => text[0])\r\n    .join('')\r\n    .toUpperCase();\r\n}\r\n\r\nexport default function UserAvatar({ user }: { user: StateContextType['user'] }) {\r\n  const classes = useStyles();\r\n  const { displayName, photoURL } = user!;\r\n\r\n  return photoURL ? (\r\n    <Avatar src={photoURL} />\r\n  ) : (\r\n    <Avatar className={classes.red}>{displayName ? getInitials(displayName) : <Person />}</Avatar>\r\n  );\r\n}\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport * as firebase from 'firebase/app';\r\nimport 'firebase/auth';\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\r\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\r\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\r\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\r\n};\r\n\r\nexport default function useFirebaseAuth() {\r\n  const [user, setUser] = useState<firebase.User | null>(null);\r\n  const [isAuthReady, setIsAuthReady] = useState(false);\r\n\r\n  const getToken = useCallback(\r\n    async (identity: string, roomName: string) => {\r\n      const headers = new window.Headers();\r\n\r\n      const idToken = await user!.getIdToken();\r\n      headers.set('Authorization', idToken);\r\n\r\n      const endpoint = process.env.REACT_APP_TOKEN_ENDPOINT || '/token';\r\n      const params = new window.URLSearchParams({ identity, roomName });\r\n\r\n      return fetch(`${endpoint}?${params}`, { headers }).then(res => res.text());\r\n    },\r\n    [user]\r\n  );\r\n\r\n  useEffect(() => {\r\n    firebase.initializeApp(firebaseConfig);\r\n    firebase.auth().onAuthStateChanged(user => {\r\n      setUser(user);\r\n      setIsAuthReady(true);\r\n    });\r\n  }, []);\r\n\r\n  const signIn = useCallback(() => {\r\n    const provider = new firebase.auth.GoogleAuthProvider();\r\n    provider.addScope('https://www.googleapis.com/auth/plus.login');\r\n\r\n    return firebase\r\n      .auth()\r\n      .signInWithPopup(provider)\r\n      .then(user => {\r\n        setUser(user.user);\r\n      });\r\n  }, []);\r\n\r\n  const signOut = useCallback(() => {\r\n    return firebase\r\n      .auth()\r\n      .signOut()\r\n      .then(() => {\r\n        setUser(null);\r\n      });\r\n  }, []);\r\n\r\n  return { user, signIn, signOut, isAuthReady, getToken };\r\n}\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\nexport function getPasscode() {\r\n  const match = window.location.search.match(/passcode=(.*)&?/);\r\n  const passcode = match ? match[1] : window.sessionStorage.getItem('passcode');\r\n  return passcode;\r\n}\r\n\r\nexport function fetchToken(name: string, room: string, passcode: string) {\r\n  return fetch(`/token`, {\r\n    method: 'POST',\r\n    headers: {\r\n      'content-type': 'application/json',\r\n    },\r\n    body: JSON.stringify({ user_identity: name, room_name: room, passcode }),\r\n  });\r\n}\r\n\r\nexport function verifyPasscode(passcode: string) {\r\n  return fetchToken('temp-name', 'temp-room', passcode).then(async res => {\r\n    const jsonResponse = await res.json();\r\n    if (res.status === 401) {\r\n      return { isValid: false, error: jsonResponse.error?.message };\r\n    }\r\n\r\n    if (res.ok && jsonResponse.token) {\r\n      return { isValid: true };\r\n    }\r\n  });\r\n}\r\n\r\nexport function getErrorMessage(message: string) {\r\n  switch (message) {\r\n    case 'passcode incorrect':\r\n      return 'Passcode is incorrect';\r\n    case 'passcode expired':\r\n      return 'Passcode has expired';\r\n    default:\r\n      return message;\r\n  }\r\n}\r\n\r\nexport default function usePasscodeAuth() {\r\n  const history = useHistory();\r\n\r\n  const [user, setUser] = useState<{ displayName: undefined; photoURL: undefined; passcode: string } | null>(null);\r\n  const [isAuthReady, setIsAuthReady] = useState(false);\r\n\r\n  const getToken = useCallback(\r\n    (name: string, room: string) => {\r\n      return fetchToken(name, room, user!.passcode)\r\n        .then(res => res.json())\r\n        .then(res => res.token as string);\r\n    },\r\n    [user]\r\n  );\r\n\r\n  useEffect(() => {\r\n    const passcode = getPasscode();\r\n\r\n    if (passcode) {\r\n      verifyPasscode(passcode)\r\n        .then(verification => {\r\n          if (verification?.isValid) {\r\n            setUser({ passcode } as any);\r\n            window.sessionStorage.setItem('passcode', passcode);\r\n            history.replace(window.location.pathname);\r\n          }\r\n        })\r\n        .then(() => setIsAuthReady(true));\r\n    } else {\r\n      setIsAuthReady(true);\r\n    }\r\n  }, [history]);\r\n\r\n  const signIn = useCallback((passcode: string) => {\r\n    return verifyPasscode(passcode).then(verification => {\r\n      if (verification?.isValid) {\r\n        setUser({ passcode } as any);\r\n        window.sessionStorage.setItem('passcode', passcode);\r\n      } else {\r\n        throw new Error(getErrorMessage(verification?.error));\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  const signOut = useCallback(() => {\r\n    setUser(null);\r\n    window.sessionStorage.removeItem('passcode');\r\n    return Promise.resolve();\r\n  }, []);\r\n\r\n  return { user, isAuthReady, getToken, signIn, signOut };\r\n}\r\n","import React, { createContext, useContext, useState } from 'react';\r\nimport { TwilioError } from 'twilio-video';\r\nimport useFirebaseAuth from './useFirebaseAuth/useFirebaseAuth';\r\nimport usePasscodeAuth from './usePasscodeAuth/usePasscodeAuth';\r\nimport { User } from 'firebase';\r\n\r\nexport interface StateContextType {\r\n  error: TwilioError | null;\r\n  setError(error: TwilioError | null): void;\r\n  getToken(name: string, room: string, passcode?: string): Promise<string>;\r\n  user?: User | null | { displayName: undefined; photoURL: undefined; passcode?: string };\r\n  signIn?(passcode?: string): Promise<void>;\r\n  signOut?(): Promise<void>;\r\n  isAuthReady?: boolean;\r\n}\r\n\r\nexport const StateContext = createContext<StateContextType>(null!);\r\n\r\n/*\r\n  The 'react-hooks/rules-of-hooks' linting rules prevent React Hooks fron being called\r\n  inside of if() statements. This is because hooks must always be called in the same order\r\n  every time a component is rendered. The 'react-hooks/rules-of-hooks' rule is disabled below\r\n  because the \"if (process.env.REACT_APP_SET_AUTH === 'firebase')\" statements are evaluated\r\n  at build time (not runtime). If the statement evaluates to false, then the code is not\r\n  included in the bundle that is produced (due to tree-shaking). Thus, in this instance, it\r\n  is ok to call hooks inside if() statements.\r\n*/\r\nexport default function AppStateProvider(props: React.PropsWithChildren<{}>) {\r\n  const [error, setError] = useState<TwilioError | null>(null);\r\n  let contextValue = {\r\n    error,\r\n    setError,\r\n  } as StateContextType;\r\n\r\n  if (process.env.REACT_APP_SET_AUTH === 'firebase') {\r\n    contextValue = {\r\n      ...contextValue,\r\n      ...useFirebaseAuth(), // eslint-disable-line react-hooks/rules-of-hooks\r\n    };\r\n  } else if (process.env.REACT_APP_SET_AUTH === 'passcode') {\r\n    contextValue = {\r\n      ...contextValue,\r\n      ...usePasscodeAuth(), // eslint-disable-line react-hooks/rules-of-hooks\r\n    };\r\n  } else {\r\n    contextValue = {\r\n      ...contextValue,\r\n      getToken: async (identity, roomName) => {\r\n        const headers = new window.Headers();\r\n        const endpoint = process.env.REACT_APP_TOKEN_ENDPOINT || '/token';\r\n        const params = new window.URLSearchParams({ identity, roomName });\r\n\r\n        return fetch(`${endpoint}?${params}`, { headers }).then(res => res.text());\r\n      },\r\n    };\r\n  }\r\n\r\n  const getToken: StateContextType['getToken'] = (name, room) =>\r\n    contextValue.getToken(name, room).catch(err => {\r\n      setError(err);\r\n      return Promise.reject(err);\r\n    });\r\n\r\n  return <StateContext.Provider value={{ ...contextValue, getToken }}>{props.children}</StateContext.Provider>;\r\n}\r\n\r\nexport function useAppState() {\r\n  const context = useContext(StateContext);\r\n  if (!context) {\r\n    throw new Error('useAppState must be used within the AppStateProvider');\r\n  }\r\n  return context;\r\n}\r\n","import React, { useState, useRef, useCallback } from 'react';\r\nimport AboutDialog from '../AboutDialog/AboutDialog';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuContainer from '@material-ui/core/Menu';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport MoreIcon from '@material-ui/icons/MoreVert';\r\nimport UserAvatar from '../UserAvatar/UserAvatar';\r\n\r\nimport { useAppState } from '../../../state';\r\nimport useVideoContext from '../../../hooks/useVideoContext/useVideoContext';\r\n\r\nexport default function Menu() {\r\n  const { user, signOut } = useAppState();\r\n  const { room, localTracks } = useVideoContext();\r\n\r\n  const [aboutOpen, setAboutOpen] = useState(false);\r\n  const [menuOpen, setMenuOpen] = useState(false);\r\n\r\n  const anchorRef = useRef<HTMLDivElement>(null);\r\n\r\n  const handleSignOut = useCallback(() => {\r\n    room.disconnect?.();\r\n    localTracks.forEach(track => track.stop());\r\n    signOut?.();\r\n  }, [room.disconnect, localTracks, signOut]);\r\n\r\n  return (\r\n    <div ref={anchorRef}>\r\n      <IconButton color=\"inherit\" onClick={() => setMenuOpen(state => !state)}>\r\n        {user ? <UserAvatar user={user} /> : <MoreIcon />}\r\n      </IconButton>\r\n      <MenuContainer open={menuOpen} onClose={() => setMenuOpen(state => !state)} anchorEl={anchorRef.current}>\r\n        {user?.displayName && <MenuItem disabled>{user.displayName}</MenuItem>}\r\n        <MenuItem onClick={() => setAboutOpen(true)}>About</MenuItem>\r\n        {user && <MenuItem onClick={handleSignOut}>Logout</MenuItem>}\r\n      </MenuContainer>\r\n      <AboutDialog\r\n        open={aboutOpen}\r\n        onClose={() => {\r\n          setAboutOpen(false);\r\n          setMenuOpen(false);\r\n        }}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import React, { ChangeEvent, FormEvent, useState, useEffect } from 'react';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\n\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport ToggleFullscreenButton from '../ToggleFullScreenButton/ToggleFullScreenButton';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Menu from './Menu/Menu';\r\n\r\nimport { useAppState } from '../../state';\r\nimport { useParams } from 'react-router-dom';\r\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\nimport { Typography } from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    container: {\r\n      backgroundColor: theme.palette.background.default,\r\n    },\r\n    form: {\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n    },\r\n    textField: {\r\n      marginLeft: theme.spacing(1),\r\n      marginRight: theme.spacing(1),\r\n      width: 200,\r\n    },\r\n    loadingSpinner: {\r\n      marginLeft: '1em',\r\n    },\r\n    displayName: {\r\n      marginLeft: '2.2em',\r\n      minWidth: '200px',\r\n      fontWeight: 600,\r\n    },\r\n  })\r\n);\r\n\r\nexport default function MenuBar() {\r\n  const classes = useStyles();\r\n  const { URLRoomName } = useParams();\r\n  const { user, getToken } = useAppState();\r\n  const { isConnecting, connect } = useVideoContext();\r\n  const roomState = useRoomState();\r\n\r\n  const [name, setName] = useState<string>(user?.displayName || '');\r\n  const [roomName, setRoomName] = useState<string>('');\r\n\r\n  useEffect(() => {\r\n    if (URLRoomName) {\r\n      setRoomName(URLRoomName);\r\n    }\r\n  }, [URLRoomName]);\r\n\r\n  const handleNameChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n    setName(event.target.value);\r\n  };\r\n\r\n  const handleRoomNameChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n    setRoomName(event.target.value);\r\n  };\r\n\r\n  const handleSubmit = (event: FormEvent<HTMLFormElement>) => {\r\n    event.preventDefault();\r\n    // If this app is deployed as a twilio function, don't change the URL beacuse routing isn't supported.\r\n    if (!window.location.origin.includes('twil.io')) {\r\n      window.history.replaceState(null, '', window.encodeURI(`/room/${roomName}`));\r\n    }\r\n    getToken(name, roomName).then(token => connect(token));\r\n  };\r\n\r\n  return (\r\n    <AppBar className={classes.container} position=\"static\">\r\n      <Toolbar>\r\n        {roomState === 'disconnected' ? (\r\n          <form className={classes.form} onSubmit={handleSubmit}>\r\n            {!user?.displayName ? (\r\n              <TextField\r\n                id=\"menu-name\"\r\n                label=\"Name\"\r\n                className={classes.textField}\r\n                value={name}\r\n                onChange={handleNameChange}\r\n                margin=\"dense\"\r\n              />\r\n            ) : (\r\n              <Typography className={classes.displayName} variant=\"body1\">\r\n                {user.displayName}\r\n              </Typography>\r\n            )}\r\n            <TextField\r\n              id=\"menu-room\"\r\n              label=\"Room\"\r\n              className={classes.textField}\r\n              value={roomName}\r\n              onChange={handleRoomNameChange}\r\n              margin=\"dense\"\r\n            />\r\n            <Button type=\"submit\" color=\"primary\" variant=\"contained\" disabled={isConnecting || !name || !roomName}>\r\n              Join Room\r\n            </Button>\r\n            {isConnecting && <CircularProgress className={classes.loadingSpinner} />}\r\n          </form>\r\n        ) : (\r\n          <h3>{roomName}</h3>\r\n        )}\r\n        <ToggleFullscreenButton />\r\n        <Menu />\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport InfoIcon from '@material-ui/icons/Info';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport { SnackbarContent } from '@material-ui/core';\r\n\r\nimport useRoomState from '../../hooks/useRoomState/useRoomState';\r\n\r\nconst useStyles = makeStyles({\r\n  snackbar: {\r\n    backgroundColor: '#6db1ff',\r\n  },\r\n  message: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n  },\r\n  icon: {\r\n    marginRight: '0.8em',\r\n  },\r\n});\r\n\r\nexport default function ReconnectingNotification() {\r\n  const classes = useStyles();\r\n  const roomState = useRoomState();\r\n\r\n  return (\r\n    <Snackbar anchorOrigin={{ vertical: 'bottom', horizontal: 'right' }} open={roomState === 'reconnecting'}>\r\n      <SnackbarContent\r\n        className={classes.snackbar}\r\n        message={\r\n          <span className={classes.message}>\r\n            <InfoIcon className={classes.icon} />\r\n            Reconnecting&hellip;\r\n          </span>\r\n        }\r\n      />\r\n    </Snackbar>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { styled } from '@material-ui/core';\r\n\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\n\r\nconst BandwidthWarningContainer = styled('div')({\r\n  position: 'absolute',\r\n  zIndex: 1,\r\n  width: '100%',\r\n  display: 'flex',\r\n  flexDirection: 'column',\r\n  justifyContent: 'center',\r\n  alignItems: 'center',\r\n});\r\n\r\nconst Warning = styled('h3')({\r\n  textAlign: 'center',\r\n  margin: '0.6em 0',\r\n});\r\n\r\nexport default function BandwidthWarning() {\r\n  return (\r\n    <BandwidthWarningContainer>\r\n      <div>\r\n        <ErrorOutlineIcon fontSize=\"large\" />\r\n      </div>\r\n      <Warning>Insufficient Bandwidth</Warning>\r\n    </BandwidthWarningContainer>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { styled } from '@material-ui/core/styles';\r\n\r\nconst Container = styled('div')({\r\n  display: 'flex',\r\n  alignItems: 'flex-end',\r\n  '& div': {\r\n    width: '2px',\r\n    border: '1px solid black',\r\n    boxSizing: 'content-box',\r\n    '&:not(:last-child)': {\r\n      borderRight: 'none',\r\n    },\r\n  },\r\n});\r\n\r\nconst STEP = 3;\r\n\r\nexport default function NetworkQualityLevel({ qualityLevel }: { qualityLevel: number | null }) {\r\n  if (qualityLevel === null) return null;\r\n  return (\r\n    <Container>\r\n      {[0, 1, 2, 3, 4].map(level => (\r\n        <div\r\n          key={level}\r\n          style={{\r\n            height: `${STEP * (level + 1)}px`,\r\n            background: qualityLevel > level ? '#0c0' : '#040',\r\n          }}\r\n        />\r\n      ))}\r\n    </Container>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { LocalParticipant, RemoteParticipant } from 'twilio-video';\r\nimport useParticipantIsReconnecting from '../../../hooks/useParticipantIsReconnecting/useParticipantIsReconnecting';\r\nimport { Tooltip } from '@material-ui/core';\r\n\r\nconst useStyles = makeStyles({\r\n  indicator: {\r\n    width: '10px',\r\n    height: '10px',\r\n    borderRadius: '100%',\r\n    background: '#0c0',\r\n    display: 'inline-block',\r\n    marginRight: '3px',\r\n  },\r\n  isReconnecting: {\r\n    background: '#ffb100',\r\n  },\r\n});\r\n\r\nexport default function ParticipantConnectionIndicator({\r\n  participant,\r\n}: {\r\n  participant: LocalParticipant | RemoteParticipant;\r\n}) {\r\n  const isReconnecting = useParticipantIsReconnecting(participant);\r\n  const classes = useStyles();\r\n  return (\r\n    <Tooltip title={isReconnecting ? 'Participant is reconnecting' : 'Participant is connected'}>\r\n      <span className={clsx(classes.indicator, { [classes.isReconnecting]: isReconnecting })}></span>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { LocalParticipant, RemoteParticipant } from 'twilio-video';\r\n\r\nexport default function useParticipantIsReconnecting(participant: LocalParticipant | RemoteParticipant) {\r\n  const [isReconnecting, setIsReconnecting] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const handleReconnecting = () => setIsReconnecting(true);\r\n    const handleReconnected = () => setIsReconnecting(false);\r\n\r\n    participant.on('reconnecting', handleReconnecting);\r\n    participant.on('reconnected', handleReconnected);\r\n    return () => {\r\n      participant.off('reconnecting', handleReconnecting);\r\n      participant.off('reconnected', handleReconnected);\r\n    };\r\n  }, [participant]);\r\n\r\n  return isReconnecting;\r\n}\r\n","import React from 'react';\r\nimport { Pin } from '@primer/octicons-react';\r\nimport Tooltip from '@material-ui/core/Tooltip';\r\nimport SvgIcon from '@material-ui/core/SvgIcon';\r\n\r\nexport default function PinIcon() {\r\n  return (\r\n    <Tooltip title=\"Participant is pinned. Click to un-pin.\" placement=\"top\">\r\n      <SvgIcon style={{ float: 'right', fontSize: '29px' }}>\r\n        <Pin />\r\n      </SvgIcon>\r\n    </Tooltip>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { LocalTrackPublication, Participant, RemoteTrackPublication } from 'twilio-video';\r\n\r\ntype TrackPublication = LocalTrackPublication | RemoteTrackPublication;\r\n\r\nexport default function usePublications(participant: Participant) {\r\n  const [publications, setPublications] = useState<TrackPublication[]>([]);\r\n\r\n  useEffect(() => {\r\n    // Reset the publications when the 'participant' variable changes.\r\n    setPublications(Array.from(participant.tracks.values()) as TrackPublication[]);\r\n\r\n    const publicationAdded = (publication: TrackPublication) =>\r\n      setPublications(prevPublications => [...prevPublications, publication]);\r\n    const publicationRemoved = (publication: TrackPublication) =>\r\n      setPublications(prevPublications => prevPublications.filter(p => p !== publication));\r\n\r\n    participant.on('trackPublished', publicationAdded);\r\n    participant.on('trackUnpublished', publicationRemoved);\r\n    return () => {\r\n      participant.off('trackPublished', publicationAdded);\r\n      participant.off('trackUnpublished', publicationRemoved);\r\n    };\r\n  }, [participant]);\r\n\r\n  return publications;\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { LocalVideoTrack, RemoteVideoTrack } from 'twilio-video';\r\n\r\ntype TrackType = RemoteVideoTrack | LocalVideoTrack | undefined | null;\r\n\r\n// The 'switchedOff' event is emitted when there is not enough bandwidth to support\r\n// a track. See: https://www.twilio.com/docs/video/tutorials/using-bandwidth-profile-api#understanding-track-switch-offs\r\n\r\nexport default function useIsTrackSwitchedOff(track: TrackType) {\r\n  const [isSwitchedOff, setIsSwitchedOff] = useState(track && track.isSwitchedOff);\r\n\r\n  useEffect(() => {\r\n    // Reset the value if the 'track' variable changes\r\n    setIsSwitchedOff(track && track.isSwitchedOff);\r\n\r\n    if (track) {\r\n      const handleSwitchedOff = () => setIsSwitchedOff(true);\r\n      const handleSwitchedOn = () => setIsSwitchedOff(false);\r\n      track.on('switchedOff', handleSwitchedOff);\r\n      track.on('switchedOn', handleSwitchedOn);\r\n      return () => {\r\n        track.off('switchedOff', handleSwitchedOff);\r\n        track.off('switchedOn', handleSwitchedOn);\r\n      };\r\n    }\r\n  }, [track]);\r\n\r\n  return !!isSwitchedOff;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { LocalTrackPublication, RemoteTrackPublication } from 'twilio-video';\r\n\r\nexport default function useTrack(publication: LocalTrackPublication | RemoteTrackPublication | undefined) {\r\n  const [track, setTrack] = useState(publication && publication.track);\r\n\r\n  useEffect(() => {\r\n    // Reset the track when the 'publication' variable changes.\r\n    setTrack(publication && publication.track);\r\n\r\n    if (publication) {\r\n      const removeTrack = () => setTrack(null);\r\n\r\n      publication.on('subscribed', setTrack);\r\n      publication.on('unsubscribed', removeTrack);\r\n      return () => {\r\n        publication.off('subscribed', setTrack);\r\n        publication.off('unsubscribed', removeTrack);\r\n      };\r\n    }\r\n  }, [publication]);\r\n\r\n  return track;\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\r\nimport { LocalParticipant, RemoteParticipant, RemoteVideoTrack, LocalVideoTrack } from 'twilio-video';\r\n\r\nimport BandwidthWarning from '../BandwidthWarning/BandwidthWarning';\r\nimport MicOff from '@material-ui/icons/MicOff';\r\nimport NetworkQualityLevel from '../NewtorkQualityLevel/NetworkQualityLevel';\r\nimport ParticipantConnectionIndicator from './ParticipantConnectionIndicator/ParticipantConnectionIndicator';\r\nimport PinIcon from './PinIcon/PinIcon';\r\nimport ScreenShare from '@material-ui/icons/ScreenShare';\r\nimport VideocamOff from '@material-ui/icons/VideocamOff';\r\n\r\nimport useParticipantNetworkQualityLevel from '../../hooks/useParticipantNetworkQualityLevel/useParticipantNetworkQualityLevel';\r\nimport usePublications from '../../hooks/usePublications/usePublications';\r\nimport useIsTrackSwitchedOff from '../../hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff';\r\nimport usePublicationIsTrackEnabled from '../../hooks/usePublicationIsTrackEnabled/usePublicationIsTrackEnabled';\r\nimport useTrack from '../../hooks/useTrack/useTrack';\r\n\r\nconst useStyles = makeStyles((theme: Theme) =>\r\n  createStyles({\r\n    container: {\r\n      position: 'relative',\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n      height: `${(theme.sidebarWidth * 9) / 16}px`,\r\n      overflow: 'hidden',\r\n      cursor: 'pointer',\r\n      '& video': {\r\n        filter: 'none',\r\n      },\r\n      '& svg': {\r\n        stroke: 'black',\r\n        strokeWidth: '0.8px',\r\n      },\r\n    },\r\n    isVideoSwitchedOff: {\r\n      '& video': {\r\n        filter: 'blur(4px) grayscale(1) brightness(0.5)',\r\n      },\r\n    },\r\n    infoContainer: {\r\n      position: 'absolute',\r\n      zIndex: 1,\r\n      display: 'flex',\r\n      flexDirection: 'column',\r\n      justifyContent: 'space-between',\r\n      height: '100%',\r\n      padding: '0.4em',\r\n      width: '100%',\r\n      background: 'transparent',\r\n    },\r\n    hideVideo: {\r\n      background: 'black',\r\n    },\r\n    identity: {\r\n      background: 'rgba(0, 0, 0, 0.7)',\r\n      padding: '0.1em 0.3em',\r\n      margin: 0,\r\n      display: 'flex',\r\n      alignItems: 'center',\r\n    },\r\n    infoRow: {\r\n      display: 'flex',\r\n      justifyContent: 'space-between',\r\n    },\r\n  })\r\n);\r\n\r\ninterface ParticipantInfoProps {\r\n  participant: LocalParticipant | RemoteParticipant;\r\n  children: React.ReactNode;\r\n  onClick: () => void;\r\n  isSelected: boolean;\r\n}\r\n\r\nexport default function ParticipantInfo({ participant, onClick, isSelected, children }: ParticipantInfoProps) {\r\n  const publications = usePublications(participant);\r\n\r\n  const audioPublication = publications.find(p => p.kind === 'audio');\r\n  const videoPublication = publications.find(p => p.trackName === 'camera');\r\n\r\n  const networkQualityLevel = useParticipantNetworkQualityLevel(participant);\r\n  const isAudioEnabled = usePublicationIsTrackEnabled(audioPublication);\r\n  const isVideoEnabled = Boolean(videoPublication);\r\n  const isScreenShareEnabled = publications.find(p => p.trackName === 'screen');\r\n\r\n  const videoTrack = useTrack(videoPublication);\r\n  const isVideoSwitchedOff = useIsTrackSwitchedOff(videoTrack as LocalVideoTrack | RemoteVideoTrack);\r\n\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div\r\n      className={clsx(classes.container, {\r\n        [classes.isVideoSwitchedOff]: isVideoSwitchedOff,\r\n      })}\r\n      onClick={onClick}\r\n      data-cy-participant={participant.identity}\r\n    >\r\n      <div className={clsx(classes.infoContainer, { [classes.hideVideo]: !isVideoEnabled })}>\r\n        <div className={classes.infoRow}>\r\n          <h4 className={classes.identity}>\r\n            <ParticipantConnectionIndicator participant={participant} />\r\n            {participant.identity}\r\n          </h4>\r\n          <NetworkQualityLevel qualityLevel={networkQualityLevel} />\r\n        </div>\r\n        <div>\r\n          {!isAudioEnabled && <MicOff data-cy-audio-mute-icon />}\r\n          {!isVideoEnabled && <VideocamOff />}\r\n          {isScreenShareEnabled && <ScreenShare />}\r\n          {isSelected && <PinIcon />}\r\n        </div>\r\n      </div>\r\n      {isVideoSwitchedOff && <BandwidthWarning />}\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { LocalParticipant, RemoteParticipant } from 'twilio-video';\r\n\r\nexport default function useParticipantNetworkQualityLevel(participant: LocalParticipant | RemoteParticipant) {\r\n  const [networkQualityLevel, setNetworkQualityLevel] = useState(participant.networkQualityLevel);\r\n\r\n  useEffect(() => {\r\n    const handleNewtorkQualityLevelChange = (newNetworkQualityLevel: number) =>\r\n      setNetworkQualityLevel(newNetworkQualityLevel);\r\n\r\n    setNetworkQualityLevel(participant.networkQualityLevel);\r\n    participant.on('networkQualityLevelChanged', handleNewtorkQualityLevelChange);\r\n    return () => {\r\n      participant.off('networkQualityLevelChanged', handleNewtorkQualityLevelChange);\r\n    };\r\n  }, [participant]);\r\n\r\n  return networkQualityLevel;\r\n}\r\n","import { useState, useEffect } from 'react';\r\nimport { LocalTrackPublication, RemoteTrackPublication } from 'twilio-video';\r\n\r\ntype PublicationType = LocalTrackPublication | RemoteTrackPublication;\r\n\r\nexport default function usePublicationIsTrackEnabled(publication?: PublicationType) {\r\n  const [isEnabled, setIsEnabled] = useState(publication ? publication.isTrackEnabled : false);\r\n\r\n  useEffect(() => {\r\n    setIsEnabled(publication ? publication.isTrackEnabled : false);\r\n\r\n    if (publication) {\r\n      const setEnabled = () => setIsEnabled(true);\r\n      const setDisabled = () => setIsEnabled(false);\r\n      publication.on('trackEnabled', setEnabled);\r\n      publication.on('trackDisabled', setDisabled);\r\n      return () => {\r\n        publication.off('trackEnabled', setEnabled);\r\n        publication.off('trackDisabled', setDisabled);\r\n      };\r\n    }\r\n  }, [publication]);\r\n\r\n  return isEnabled;\r\n}\r\n","import React, { useEffect, useRef } from 'react';\r\nimport { AudioTrack as IAudioTrack } from 'twilio-video';\r\n\r\ninterface AudioTrackProps {\r\n  track: IAudioTrack;\r\n}\r\n\r\nexport default function AudioTrack({ track }: AudioTrackProps) {\r\n  const ref = useRef<HTMLAudioElement>(null!);\r\n\r\n  useEffect(() => {\r\n    const el = ref.current;\r\n    track.attach(el);\r\n    return () => {\r\n      track.detach(el);\r\n    };\r\n  }, [track]);\r\n\r\n  return <audio ref={ref} />;\r\n}\r\n","import React from 'react';\r\nimport useTrack from '../../hooks/useTrack/useTrack';\r\nimport AudioTrack from '../AudioTrack/AudioTrack';\r\nimport VideoTrack from '../VideoTrack/VideoTrack';\r\n\r\nimport { IVideoTrack } from '../../types';\r\nimport {\r\n  AudioTrack as IAudioTrack,\r\n  LocalTrackPublication,\r\n  Participant,\r\n  RemoteTrackPublication,\r\n  Track,\r\n} from 'twilio-video';\r\n\r\ninterface PublicationProps {\r\n  publication: LocalTrackPublication | RemoteTrackPublication;\r\n  participant: Participant;\r\n  isLocal: boolean;\r\n  disableAudio?: boolean;\r\n  videoPriority?: Track.Priority;\r\n}\r\n\r\nexport default function Publication({ publication, isLocal, disableAudio, videoPriority }: PublicationProps) {\r\n  const track = useTrack(publication);\r\n\r\n  if (!track) return null;\r\n\r\n  switch (track.kind) {\r\n    case 'video':\r\n      return (\r\n        <VideoTrack\r\n          track={track as IVideoTrack}\r\n          priority={videoPriority}\r\n          isLocal={track.name === 'camera' && isLocal}\r\n        />\r\n      );\r\n    case 'audio':\r\n      return disableAudio ? null : <AudioTrack track={track as IAudioTrack} />;\r\n    default:\r\n      return null;\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { LocalParticipant, RemoteParticipant, Track } from 'twilio-video';\r\nimport Publication from '../Publication/Publication';\r\nimport usePublications from '../../hooks/usePublications/usePublications';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\n\r\ninterface ParticipantTracksProps {\r\n  participant: LocalParticipant | RemoteParticipant;\r\n  disableAudio?: boolean;\r\n  enableScreenShare?: boolean;\r\n  videoPriority?: Track.Priority;\r\n}\r\n\r\n/*\r\n *  The object model for the Room object (found here: https://www.twilio.com/docs/video/migrating-1x-2x#object-model) shows\r\n *  that Participant objects have TrackPublications, and TrackPublication objects have Tracks.\r\n *\r\n *  The React components in this application follow the same pattern. This ParticipantTracks component renders Publications,\r\n *  and the Publication component renders Tracks.\r\n */\r\n\r\nexport default function ParticipantTracks({\r\n  participant,\r\n  disableAudio,\r\n  enableScreenShare,\r\n  videoPriority,\r\n}: ParticipantTracksProps) {\r\n  const { room } = useVideoContext();\r\n  const publications = usePublications(participant);\r\n  const isLocal = participant === room.localParticipant;\r\n\r\n  let filteredPublications;\r\n\r\n  if (enableScreenShare && publications.some(p => p.trackName === 'screen')) {\r\n    filteredPublications = publications.filter(p => p.trackName !== 'camera');\r\n  } else {\r\n    filteredPublications = publications.filter(p => p.trackName !== 'screen');\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {filteredPublications.map(publication => (\r\n        <Publication\r\n          key={publication.kind}\r\n          publication={publication}\r\n          participant={participant}\r\n          isLocal={isLocal}\r\n          disableAudio={disableAudio}\r\n          videoPriority={videoPriority}\r\n        />\r\n      ))}\r\n    </>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport ParticipantInfo from '../ParticipantInfo/ParticipantInfo';\r\nimport ParticipantTracks from '../ParticipantTracks/ParticipantTracks';\r\nimport { LocalParticipant, RemoteParticipant } from 'twilio-video';\r\n\r\ninterface ParticipantProps {\r\n  participant: LocalParticipant | RemoteParticipant;\r\n  disableAudio?: boolean;\r\n  enableScreenShare?: boolean;\r\n  onClick: () => void;\r\n  isSelected: boolean;\r\n}\r\n\r\nexport default function Participant({\r\n  participant,\r\n  disableAudio,\r\n  enableScreenShare,\r\n  onClick,\r\n  isSelected,\r\n}: ParticipantProps) {\r\n  return (\r\n    <ParticipantInfo participant={participant} onClick={onClick} isSelected={isSelected}>\r\n      <ParticipantTracks participant={participant} disableAudio={disableAudio} enableScreenShare={enableScreenShare} />\r\n    </ParticipantInfo>\r\n  );\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\nimport { RemoteParticipant } from 'twilio-video';\r\n\r\nexport default function useDominantSpeaker() {\r\n  const { room } = useVideoContext();\r\n  const [dominantSpeaker, setDominantSpeaker] = useState(room.dominantSpeaker);\r\n\r\n  useEffect(() => {\r\n    // Sometimes, the 'dominantSpeakerChanged' event can emit 'null', which means that\r\n    // there is no dominant speaker. If we change the main participant when 'null' is\r\n    // emitted, the effect can be jarring to the user. Here we ignore any 'null' values\r\n    // and continue to display the previous dominant speaker as the main participant.\r\n    const handleDominantSpeakerChanged = (newDominantSpeaker: RemoteParticipant) => {\r\n      if (newDominantSpeaker !== null) {\r\n        setDominantSpeaker(newDominantSpeaker);\r\n      }\r\n    };\r\n\r\n    // Since 'null' values are ignored, we will need to listen for the 'participantDisconnected'\r\n    // event, so we can set the dominantSpeaker to 'null' when they disconnect.\r\n    const handleParticipantDisconnected = (participant: RemoteParticipant) => {\r\n      setDominantSpeaker(prevDominantSpeaker => {\r\n        return prevDominantSpeaker === participant ? null : prevDominantSpeaker;\r\n      });\r\n    };\r\n\r\n    room.on('dominantSpeakerChanged', handleDominantSpeakerChanged);\r\n    room.on('participantDisconnected', handleParticipantDisconnected);\r\n    return () => {\r\n      room.off('dominantSpeakerChanged', handleDominantSpeakerChanged);\r\n      room.off('participantDisconnected', handleParticipantDisconnected);\r\n    };\r\n  }, [room]);\r\n\r\n  return dominantSpeaker;\r\n}\r\n","import { useEffect, useState } from 'react';\r\nimport { RemoteParticipant } from 'twilio-video';\r\nimport useDominantSpeaker from '../useDominantSpeaker/useDominantSpeaker';\r\nimport useVideoContext from '../useVideoContext/useVideoContext';\r\n\r\nexport default function useParticipants() {\r\n  const { room } = useVideoContext();\r\n  const dominantSpeaker = useDominantSpeaker();\r\n  const [participants, setParticipants] = useState(Array.from(room.participants.values()));\r\n\r\n  // When the dominant speaker changes, they are moved to the front of the participants array.\r\n  // This means that the most recent dominant speakers will always be near the top of the\r\n  // ParticipantStrip component.\r\n  useEffect(() => {\r\n    if (dominantSpeaker) {\r\n      setParticipants(prevParticipants => [\r\n        dominantSpeaker,\r\n        ...prevParticipants.filter(participant => participant !== dominantSpeaker),\r\n      ]);\r\n    }\r\n  }, [dominantSpeaker]);\r\n\r\n  useEffect(() => {\r\n    const participantConnected = (participant: RemoteParticipant) =>\r\n      setParticipants(prevParticipants => [...prevParticipants, participant]);\r\n    const participantDisconnected = (participant: RemoteParticipant) =>\r\n      setParticipants(prevParticipants => prevParticipants.filter(p => p !== participant));\r\n    room.on('participantConnected', participantConnected);\r\n    room.on('participantDisconnected', participantDisconnected);\r\n    return () => {\r\n      room.off('participantConnected', participantConnected);\r\n      room.off('participantDisconnected', participantDisconnected);\r\n    };\r\n  }, [room]);\r\n\r\n  return participants;\r\n}\r\n","import React from 'react';\r\nimport Participant from '../Participant/Participant';\r\nimport { styled } from '@material-ui/core/styles';\r\nimport useParticipants from '../../hooks/useParticipants/useParticipants';\r\nimport useVideoContext from '../../hooks/useVideoContext/useVideoContext';\r\nimport useSelectedParticipant from '../VideoProvider/useSelectedParticipant/useSelectedParticipant';\r\n\r\nconst Container = styled('aside')(({ theme }) => ({\r\n  position: 'absolute',\r\n  top: 0,\r\n  bottom: 0,\r\n  right: `calc(100% - ${theme.sidebarWidth}px)`,\r\n  left: 0,\r\n  padding: '0.5em',\r\n  overflowY: 'auto',\r\n}));\r\n\r\nexport default function ParticipantStrip() {\r\n  const {\r\n    room: { localParticipant },\r\n  } = useVideoContext();\r\n  const participants = useParticipants();\r\n  const [selectedParticipant, setSelectedParticipant] = useSelectedParticipant();\r\n\r\n  return (\r\n    <Container>\r\n      <Participant\r\n        participant={localParticipant}\r\n        isSelected={selectedParticipant === localParticipant}\r\n        onClick={() => setSelectedParticipant(localParticipant)}\r\n      />\r\n      {participants.map(participant => (\r\n        <Participant\r\n          key={participant.sid}\r\n          participant={participant}\r\n          isSelected={selectedParticipant === participant}\r\n          onClick={() => setSelectedParticipant(participant)}\r\n        />\r\n      ))}\r\n    </Container>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { LocalParticipant, RemoteParticipant, RemoteVideoTrack, LocalVideoTrack } from 'twilio-video';\r\n\r\nimport BandwidthWarning from '../BandwidthWarning/BandwidthWarning';\r\nimport useIsTrackSwitchedOff from '../../hooks/useIsTrackSwitchedOff/useIsTrackSwitchedOff';\r\nimport usePublications from '../../hooks/usePublications/usePublications';\r\nimport useTrack from '../../hooks/useTrack/useTrack';\r\nimport VideocamOff from '@material-ui/icons/VideocamOff';\r\n\r\nconst useStyles = makeStyles({\r\n  container: {\r\n    position: 'relative',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n  },\r\n  isVideoSwitchedOff: {\r\n    '& video': {\r\n      filter: 'blur(4px) grayscale(1) brightness(0.5)',\r\n    },\r\n  },\r\n  identity: {\r\n    background: 'rgba(0, 0, 0, 0.7)',\r\n    padding: '0.1em 0.3em',\r\n    margin: '1em',\r\n    fontSize: '1.2em',\r\n    display: 'inline-flex',\r\n    '& svg': {\r\n      marginLeft: '0.3em',\r\n    },\r\n  },\r\n  infoContainer: {\r\n    position: 'absolute',\r\n    zIndex: 1,\r\n    height: '100%',\r\n    padding: '0.4em',\r\n    width: '100%',\r\n  },\r\n});\r\n\r\ninterface MainParticipantInfoProps {\r\n  participant: LocalParticipant | RemoteParticipant;\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport default function MainParticipantInfo({ participant, children }: MainParticipantInfoProps) {\r\n  const classes = useStyles();\r\n\r\n  const publications = usePublications(participant);\r\n  const videoPublication = publications.find(p => p.trackName === 'camera');\r\n  const screenSharePublication = publications.find(p => p.trackName === 'screen');\r\n  const isVideoEnabled = Boolean(videoPublication);\r\n\r\n  const videoTrack = useTrack(screenSharePublication || videoPublication);\r\n  const isVideoSwitchedOff = useIsTrackSwitchedOff(videoTrack as LocalVideoTrack | RemoteVideoTrack);\r\n\r\n  return (\r\n    <div\r\n      data-cy-main-participant\r\n      className={clsx(classes.container, { [classes.isVideoSwitchedOff]: isVideoSwitchedOff })}\r\n    >\r\n      <div className={classes.infoContainer}>\r\n        <h4 className={classes.identity}>\r\n          {participant.identity}\r\n          {!isVideoEnabled && <VideocamOff />}\r\n        </h4>\r\n      </div>\r\n      {isVideoSwitchedOff && <BandwidthWarning />}\r\n      {children}\r\n    </div>\r\n  );\r\n}\r\n","import MainParticipantInfo from '../MainParticipantInfo/MainParticipantInfo';\r\nimport ParticipantTracks from '../ParticipantTracks/ParticipantTracks';\r\nimport React from 'react';\r\nimport useMainSpeaker from '../../hooks/useMainSpeaker/useMainSpeaker';\r\n\r\nexport default function MainParticipant() {\r\n  const mainParticipant = useMainSpeaker();\r\n  return (\r\n    /* audio is disabled for this participant component because this participant's audio \r\n       is already being rendered in the <ParticipantStrip /> component.  */\r\n    <MainParticipantInfo participant={mainParticipant}>\r\n      <ParticipantTracks participant={mainParticipant} disableAudio enableScreenShare videoPriority=\"high\" />\r\n    </MainParticipantInfo>\r\n  );\r\n}\r\n","import useVideoContext from '../useVideoContext/useVideoContext';\r\nimport useDominantSpeaker from '../useDominantSpeaker/useDominantSpeaker';\r\nimport useParticipants from '../useParticipants/useParticipants';\r\nimport useScreenShareParticipant from '../useScreenShareParticipant/useScreenShareParticipant';\r\nimport useSelectedParticipant from '../../components/VideoProvider/useSelectedParticipant/useSelectedParticipant';\r\n\r\nexport default function useMainSpeaker() {\r\n  const [selectedParticipant] = useSelectedParticipant();\r\n  const screenShareParticipant = useScreenShareParticipant();\r\n  const dominantSpeaker = useDominantSpeaker();\r\n  const participants = useParticipants();\r\n  const {\r\n    room: { localParticipant },\r\n  } = useVideoContext();\r\n\r\n  // The participant that is returned is displayed in the main video area. Changing the order of the following\r\n  // variables will change the how the main speaker is determined.\r\n  return selectedParticipant || screenShareParticipant || dominantSpeaker || participants[0] || localParticipant;\r\n}\r\n","import React from 'react';\r\nimport ParticipantStrip from '../ParticipantStrip/ParticipantStrip';\r\nimport { styled } from '@material-ui/core/styles';\r\nimport MainParticipant from '../MainParticipant/MainParticipant';\r\n\r\nconst Container = styled('div')({\r\n  position: 'relative',\r\n  height: '100%',\r\n});\r\n\r\nconst MainParticipantContainer = styled('div')(({ theme }) => ({\r\n  position: 'absolute',\r\n  left: theme.sidebarWidth,\r\n  right: 0,\r\n  top: 0,\r\n  bottom: 0,\r\n  '& > div': {\r\n    height: '100%',\r\n  },\r\n}));\r\n\r\nexport default function Room() {\r\n  return (\r\n    <Container>\r\n      <ParticipantStrip />\r\n      <MainParticipantContainer>\r\n        <MainParticipant />\r\n      </MainParticipantContainer>\r\n    </Container>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { styled } from '@material-ui/core/styles';\r\n\r\nimport Controls from './components/Controls/Controls';\r\nimport LocalVideoPreview from './components/LocalVideoPreview/LocalVideoPreview';\r\nimport MenuBar from './components/MenuBar/MenuBar';\r\nimport ReconnectingNotification from './components/ReconnectingNotification/ReconnectingNotification';\r\nimport Room from './components/Room/Room';\r\n\r\nimport useRoomState from './hooks/useRoomState/useRoomState';\r\n\r\nconst Container = styled('div')({\r\n  display: 'flex',\r\n  flexDirection: 'column',\r\n  height: '100vh',\r\n});\r\n\r\nconst Main = styled('main')({\r\n  height: '100%',\r\n  position: 'relative',\r\n});\r\n\r\nexport default function App() {\r\n  const roomState = useRoomState();\r\n\r\n  return (\r\n    <Container>\r\n      <MenuBar />\r\n      <Main>\r\n        {roomState === 'disconnected' ? <LocalVideoPreview /> : <Room />}\r\n        <Controls />\r\n      </Main>\r\n      <ReconnectingNotification />\r\n    </Container>\r\n  );\r\n}\r\n","import React, { PropsWithChildren } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport DialogContentText from '@material-ui/core/DialogContentText';\r\nimport enhanceMessage from './enhanceMessage';\r\nimport { TwilioError } from 'twilio-video';\r\n\r\ninterface ErrorDialogProps {\r\n  dismissError: Function;\r\n  error: TwilioError | null;\r\n}\r\n\r\nfunction ErrorDialog({ dismissError, error }: PropsWithChildren<ErrorDialogProps>) {\r\n  const { message, code } = error || {};\r\n  const enhancedMessage = enhanceMessage(message, code);\r\n\r\n  return (\r\n    <Dialog open={error !== null} onClose={() => dismissError()} fullWidth={true} maxWidth=\"xs\">\r\n      <DialogTitle>ERROR</DialogTitle>\r\n      <DialogContent>\r\n        <DialogContentText>{enhancedMessage}</DialogContentText>\r\n        {code && (\r\n          <pre>\r\n            <code>Error Code: {code}</code>\r\n          </pre>\r\n        )}\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => dismissError()} color=\"primary\" autoFocus>\r\n          OK\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nexport default ErrorDialog;\r\n","// This function is used to provide error messages to the user that are\r\n// different than the error messages provided by the SDK.\r\nexport default function enhanceMessage(message = '', code?: number) {\r\n  switch (code) {\r\n    case 20101: // Invalid token error\r\n      return message + '. Please make sure you are using the correct credentials.';\r\n    default:\r\n      return message;\r\n  }\r\n}\r\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"title\", null, \"btn_google_light_normal_ios\");\n\nvar _ref3 =\n/*#__PURE__*/\nReact.createElement(\"desc\", null, \"Created with Sketch.\");\n\nvar _ref4 =\n/*#__PURE__*/\nReact.createElement(\"defs\", null, React.createElement(\"filter\", {\n  x: \"-50%\",\n  y: \"-50%\",\n  width: \"200%\",\n  height: \"200%\",\n  filterUnits: \"objectBoundingBox\",\n  id: \"filter-1\"\n}, React.createElement(\"feOffset\", {\n  dx: 0,\n  dy: 1,\n  in: \"SourceAlpha\",\n  result: \"shadowOffsetOuter1\"\n}), React.createElement(\"feGaussianBlur\", {\n  stdDeviation: 0.5,\n  in: \"shadowOffsetOuter1\",\n  result: \"shadowBlurOuter1\"\n}), React.createElement(\"feColorMatrix\", {\n  values: \"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.168 0\",\n  in: \"shadowBlurOuter1\",\n  type: \"matrix\",\n  result: \"shadowMatrixOuter1\"\n}), React.createElement(\"feOffset\", {\n  dx: 0,\n  dy: 0,\n  in: \"SourceAlpha\",\n  result: \"shadowOffsetOuter2\"\n}), React.createElement(\"feGaussianBlur\", {\n  stdDeviation: 0.5,\n  in: \"shadowOffsetOuter2\",\n  result: \"shadowBlurOuter2\"\n}), React.createElement(\"feColorMatrix\", {\n  values: \"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.084 0\",\n  in: \"shadowBlurOuter2\",\n  type: \"matrix\",\n  result: \"shadowMatrixOuter2\"\n}), React.createElement(\"feMerge\", null, React.createElement(\"feMergeNode\", {\n  in: \"shadowMatrixOuter1\"\n}), React.createElement(\"feMergeNode\", {\n  in: \"shadowMatrixOuter2\"\n}), React.createElement(\"feMergeNode\", {\n  in: \"SourceGraphic\"\n}))), React.createElement(\"rect\", {\n  id: \"path-2\",\n  x: 0,\n  y: 0,\n  width: 40,\n  height: 40,\n  rx: 2\n}));\n\nvar _ref5 =\n/*#__PURE__*/\nReact.createElement(\"g\", {\n  id: \"Google-Button\",\n  stroke: \"none\",\n  strokeWidth: 1,\n  fill: \"none\",\n  fillRule: \"evenodd\"\n}, React.createElement(\"g\", {\n  id: \"9-PATCH\",\n  transform: \"translate(-608.000000, -160.000000)\"\n}), React.createElement(\"g\", {\n  id: \"btn_google_light_normal\",\n  transform: \"translate(-1.000000, -1.000000)\"\n}, React.createElement(\"g\", {\n  id: \"logo_googleg_48dp\",\n  transform: \"translate(15.000000, 15.000000)\"\n}, React.createElement(\"path\", {\n  d: \"M17.64,9.20454545 C17.64,8.56636364 17.5827273,7.95272727 17.4763636,7.36363636 L9,7.36363636 L9,10.845 L13.8436364,10.845 C13.635,11.97 13.0009091,12.9231818 12.0477273,13.5613636 L12.0477273,15.8195455 L14.9563636,15.8195455 C16.6581818,14.2527273 17.64,11.9454545 17.64,9.20454545 L17.64,9.20454545 Z\",\n  id: \"Shape\",\n  fill: \"#4285F4\"\n}), React.createElement(\"path\", {\n  d: \"M9,18 C11.43,18 13.4672727,17.1940909 14.9563636,15.8195455 L12.0477273,13.5613636 C11.2418182,14.1013636 10.2109091,14.4204545 9,14.4204545 C6.65590909,14.4204545 4.67181818,12.8372727 3.96409091,10.71 L0.957272727,10.71 L0.957272727,13.0418182 C2.43818182,15.9831818 5.48181818,18 9,18 L9,18 Z\",\n  id: \"Shape\",\n  fill: \"#34A853\"\n}), React.createElement(\"path\", {\n  d: \"M3.96409091,10.71 C3.78409091,10.17 3.68181818,9.59318182 3.68181818,9 C3.68181818,8.40681818 3.78409091,7.83 3.96409091,7.29 L3.96409091,4.95818182 L0.957272727,4.95818182 C0.347727273,6.17318182 0,7.54772727 0,9 C0,10.4522727 0.347727273,11.8268182 0.957272727,13.0418182 L3.96409091,10.71 L3.96409091,10.71 Z\",\n  id: \"Shape\",\n  fill: \"#FBBC05\"\n}), React.createElement(\"path\", {\n  d: \"M9,3.57954545 C10.3213636,3.57954545 11.5077273,4.03363636 12.4404545,4.92545455 L15.0218182,2.34409091 C13.4631818,0.891818182 11.4259091,0 9,0 C5.48181818,0 2.43818182,2.01681818 0.957272727,4.95818182 L3.96409091,7.29 C4.67181818,5.16272727 6.65590909,3.57954545 9,3.57954545 L9,3.57954545 Z\",\n  id: \"Shape\",\n  fill: \"#EA4335\"\n}), React.createElement(\"path\", {\n  d: \"M0,0 L18,0 L18,18 L0,18 L0,0 Z\",\n  id: \"Shape\"\n})), React.createElement(\"g\", {\n  id: \"handles_square\"\n})));\n\nvar SvgGoogleLogo = function SvgGoogleLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: \"32px\",\n    height: \"32px\",\n    viewBox: \"7 7 32 32\",\n    ref: svgRef\n  }, props), title === undefined ? _ref2 : title ? React.createElement(\"title\", null, title) : null, _ref3, _ref4, _ref5);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgGoogleLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/google-logo.06c50bce.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  d: \"M14.4 11.3c0 1.7-1.4 3.1-3.1 3.1S8.2 13 8.2 11.3s1.4-3.1 3.1-3.1 3.1 1.4 3.1 3.1zm-3.1 4.3c-1.7 0-3.1 1.4-3.1 3.1s1.4 3.1 3.1 3.1 3.1-1.4 3.1-3.1-1.4-3.1-3.1-3.1zM30 15c0 8.3-6.7 15-15 15S0 23.3 0 15 6.7 0 15 0s15 6.7 15 15zm-4 0c0-6.1-4.9-11-11-11S4 8.9 4 15s4.9 11 11 11 11-4.9 11-11zm-7.3.6c-1.7 0-3.1 1.4-3.1 3.1s1.4 3.1 3.1 3.1 3.1-1.4 3.1-3.1-1.4-3.1-3.1-3.1zm0-7.4c-1.7 0-3.1 1.4-3.1 3.1s1.4 3.1 3.1 3.1 3.1-1.4 3.1-3.1-1.4-3.1-3.1-3.1zm51.6-2.3c.1 0 .2.1.3.2v3.2c0 .2-.2.3-.3.3H65c-.2 0-.3-.2-.3-.3V6.2c0-.2.2-.3.3-.3h5.3zm-.1 4.5H60c-.1 0-.3.1-.3.3l-1.3 5-.1.3-1.6-5.3c0-.1-.2-.3-.3-.3h-4c-.1 0-.3.1-.3.3l-1.5 5-.1.3-.1-.3-.6-2.5-.6-2.5c0-.1-.2-.3-.3-.3h-8V6.1c0-.1-.2-.3-.4-.2l-5 1.6c-.2 0-.3.1-.3.3v2.7h-1.3c-.1 0-.3.1-.3.3v3.8c0 .1.1.3.3.3h1.3v4.7c0 3.3 1.8 4.8 5.1 4.8 1.4 0 2.7-.3 3.6-.8v-4c0-.2-.2-.3-.3-.2-.5.2-1 .3-1.4.3-.9 0-1.4-.4-1.4-1.4v-3.4h2.9c.1 0 .3-.1.3-.3v-3.2L47.8 24c0 .1.2.3.3.3h4.2c.1 0 .3-.1.3-.3l1.8-5.6.9 2.9.8 2.7c0 .1.2.3.3.3h4.2c.1 0 .3-.1.3-.3l3.8-12.6V24c0 .1.1.3.3.3h5.1c.1 0 .3-.1.3-.3V10.7c0-.1-.1-.3-.2-.3zm6.7-4.5h-5.1c-.1 0-.3.1-.3.3v17.7c0 .1.1.3.3.3h5.1c.1 0 .3-.1.3-.3V6.1c0-.1-.1-.2-.3-.2zm6.8 0h-5.3c-.1 0-.3.1-.3.3v3.1c0 .1.1.3.3.3h5.3c.1 0 .3-.1.3-.3V6.1c0-.1-.1-.2-.3-.2zm-.1 4.5h-5.1c-.1 0-.3.1-.3.3v13.1c0 .1.1.3.3.3h5.1c.1 0 .3-.1.3-.3V10.7c0-.1-.1-.3-.3-.3zm16.1 6.8c0 3.8-3.2 7.1-7.7 7.1-4.4 0-7.6-3.3-7.6-7.1s3.2-7.1 7.7-7.1c4.4 0 7.6 3.3 7.6 7.1zm-5.4.1c0-1.4-1-2.5-2.2-2.4-1.3 0-2.2 1.1-2.2 2.4s1 2.4 2.2 2.4c1.3 0 2.2-1.1 2.2-2.4z\"\n});\n\nvar SvgTwilioLogo = function SvgTwilioLogo(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    fill: \"#F22F46\",\n    viewBox: \"0 0 100 30\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgTwilioLogo, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/twilio-logo.62d2e629.svg\";\nexport { ForwardRef as ReactComponent };","import React, { ChangeEvent, useState, FormEvent } from 'react';\r\nimport { useAppState } from '../../state';\r\n\r\nimport Button from '@material-ui/core/Button';\r\nimport ErrorOutlineIcon from '@material-ui/icons/ErrorOutline';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { ReactComponent as GoogleLogo } from './google-logo.svg';\r\nimport { ReactComponent as TwilioLogo } from './twilio-logo.svg';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport videoLogo from './video-logo.png';\r\n\r\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { useLocation, useHistory } from 'react-router-dom';\r\n\r\nconst useStyles = makeStyles({\r\n  container: {\r\n    height: '100vh',\r\n    background: '#0D122B',\r\n  },\r\n  twilioLogo: {\r\n    width: '55%',\r\n    display: 'block',\r\n  },\r\n  videoLogo: {\r\n    width: '25%',\r\n    padding: '2.4em 0 2.1em',\r\n  },\r\n  paper: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    flexDirection: 'column',\r\n    padding: '2em',\r\n    marginTop: '4em',\r\n    background: 'white',\r\n    color: 'black',\r\n  },\r\n  button: {\r\n    color: 'black',\r\n    background: 'white',\r\n    margin: '0.8em 0 0.7em',\r\n    textTransform: 'none',\r\n  },\r\n  errorMessage: {\r\n    color: 'red',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    margin: '1em 0 0.2em',\r\n    '& svg': {\r\n      marginRight: '0.4em',\r\n    },\r\n  },\r\n});\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    type: 'light',\r\n  },\r\n});\r\n\r\nexport default function LoginPage() {\r\n  const classes = useStyles();\r\n  const { signIn, user, isAuthReady } = useAppState();\r\n  const history = useHistory();\r\n  const location = useLocation<{ from: Location }>();\r\n  const [passcode, setPasscode] = useState('');\r\n  const [authError, setAuthError] = useState<Error | null>(null);\r\n\r\n  const isAuthEnabled = Boolean(process.env.REACT_APP_SET_AUTH);\r\n\r\n  const login = () => {\r\n    setAuthError(null);\r\n    signIn?.(passcode)\r\n      .then(() => {\r\n        history.replace(location?.state?.from || { pathname: '/' });\r\n      })\r\n      .catch(err => setAuthError(err));\r\n  };\r\n\r\n  const handleSubmit = (e: FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    login();\r\n  };\r\n\r\n  if (user || !isAuthEnabled) {\r\n    history.replace('/');\r\n  }\r\n\r\n  if (!isAuthReady) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <Grid container justify=\"center\" alignItems=\"flex-start\" className={classes.container}>\r\n        <Paper className={classes.paper} elevation={6}>\r\n          <TwilioLogo className={classes.twilioLogo} />\r\n          <img className={classes.videoLogo} src={videoLogo} alt=\"Video Logo\"></img>\r\n\r\n          {process.env.REACT_APP_SET_AUTH === 'firebase' && (\r\n            <Button variant=\"contained\" className={classes.button} onClick={login} startIcon={<GoogleLogo />}>\r\n              Sign in with Google\r\n            </Button>\r\n          )}\r\n\r\n          {process.env.REACT_APP_SET_AUTH === 'passcode' && (\r\n            <form onSubmit={handleSubmit}>\r\n              <Grid container alignItems=\"center\" direction=\"column\">\r\n                <TextField\r\n                  id=\"input-passcode\"\r\n                  label=\"Passcode\"\r\n                  onChange={(e: ChangeEvent<HTMLInputElement>) => setPasscode(e.target.value)}\r\n                  type=\"password\"\r\n                />\r\n                <div>\r\n                  {authError && (\r\n                    <Typography variant=\"caption\" className={classes.errorMessage}>\r\n                      <ErrorOutlineIcon />\r\n                      {authError.message}\r\n                    </Typography>\r\n                  )}\r\n                </div>\r\n                <Button variant=\"contained\" className={classes.button} type=\"submit\" disabled={!passcode.length}>\r\n                  Submit\r\n                </Button>\r\n              </Grid>\r\n            </form>\r\n          )}\r\n        </Paper>\r\n      </Grid>\r\n    </ThemeProvider>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { Redirect, Route, RouteProps } from 'react-router-dom';\r\nimport { useAppState } from '../../state';\r\n\r\nexport default function PrivateRoute({ children, ...rest }: RouteProps) {\r\n  const { isAuthReady, user } = useAppState();\r\n    \r\n  const renderChildren = user || !process.env.REACT_APP_SET_AUTH;\r\n\r\n  if (!renderChildren && !isAuthReady) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Route\r\n      {...rest}\r\n      render={({ location }) =>\r\n        renderChildren ? (\r\n          children\r\n        ) : (\r\n          <Redirect\r\n            to={{\r\n              pathname: '/login',\r\n              state: { from: location },\r\n            }}\r\n          />\r\n        )\r\n      }\r\n    />\r\n  );\r\n}\r\n","import { createMuiTheme } from '@material-ui/core';\r\n\r\ndeclare module '@material-ui/core/styles/createMuiTheme' {\r\n  interface Theme {\r\n    sidebarWidth: number;\r\n  }\r\n\r\n  // allow configuration using `createMuiTheme`\r\n  interface ThemeOptions {\r\n    sidebarWidth?: number;\r\n  }\r\n}\r\n\r\nexport default createMuiTheme({\r\n  palette: {\r\n    type: 'dark',\r\n    primary: {\r\n      main: '#F22F46',\r\n    },\r\n  },\r\n  sidebarWidth: 260,\r\n});\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport { CssBaseline } from '@material-ui/core';\r\nimport { MuiThemeProvider } from '@material-ui/core/styles';\r\n\r\nimport App from './App';\r\nimport AppStateProvider, { useAppState } from './state';\r\nimport { BrowserRouter as Router, Redirect, Route, Switch } from 'react-router-dom';\r\nimport { ConnectOptions } from 'twilio-video';\r\nimport ErrorDialog from './components/ErrorDialog/ErrorDialog';\r\nimport LoginPage from './components/LoginPage/LoginPage';\r\nimport PrivateRoute from './components/PrivateRoute/PrivateRoute';\r\nimport theme from './theme';\r\nimport './types';\r\nimport { VideoProvider } from './components/VideoProvider';\r\n\r\n// See: https://media.twiliocdn.com/sdk/js/video/releases/2.0.0/docs/global.html#ConnectOptions\r\n// for available connection options.\r\nconst connectionOptions: ConnectOptions = {\r\n  bandwidthProfile: {\r\n    video: {\r\n      mode: 'collaboration',\r\n      renderDimensions: {\r\n        high: { height: 1080, width: 1920 },\r\n        standard: { height: 90, width: 160 },\r\n        low: { height: 90, width: 160 },\r\n      },\r\n    },\r\n  },\r\n  dominantSpeaker: true,\r\n  maxAudioBitrate: 12000,\r\n  networkQuality: { local: 1, remote: 1 },\r\n  preferredVideoCodecs: [{ codec: 'VP8', simulcast: true }],\r\n};\r\n\r\nconst VideoApp = () => {\r\n  const { error, setError } = useAppState();\r\n\r\n  return (\r\n    <VideoProvider options={connectionOptions} onError={setError}>\r\n      <ErrorDialog dismissError={() => setError(null)} error={error} />\r\n      <App />\r\n    </VideoProvider>\r\n  );\r\n};\r\n\r\nReactDOM.render(\r\n  <MuiThemeProvider theme={theme}>\r\n    <CssBaseline />\r\n    <Router>\r\n      <AppStateProvider>\r\n        <Switch>\r\n          <PrivateRoute exact path=\"/\">\r\n            <VideoApp />\r\n          </PrivateRoute>\r\n          <PrivateRoute path=\"/room/:URLRoomName\">\r\n            <VideoApp />\r\n          </PrivateRoute>\r\n          <Route path=\"/login\">\r\n            <LoginPage />\r\n          </Route>\r\n          <Redirect to=\"/\" />\r\n        </Switch>\r\n      </AppStateProvider>\r\n    </Router>\r\n  </MuiThemeProvider>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}